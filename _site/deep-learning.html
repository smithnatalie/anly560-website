<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.247">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Time Series - Natalie Smith - Deep Learning for TS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.20.0.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
        


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Time Series - Natalie Smith</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">
 <span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./introduction.html">
 <span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data-sources.html">
 <span class="menu-text">Data Sources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data-visualization.html">
 <span class="menu-text">Data Visualization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./eda.html">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./autoregressive-models.html">
 <span class="menu-text">ARMA/ARIMA/SARIMA Models</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./arimax.html">
 <span class="menu-text">ARIMAX/SARIMAX/VAR</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./financial-models.html">
 <span class="menu-text">Financial Time Series Models</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./deep-learning.html" aria-current="page">
 <span class="menu-text">Deep Learning for TS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./conclusions.html">
 <span class="menu-text">Conclusions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./references.html">
 <span class="menu-text">References</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#univariate-deep-learning-prediction-can-the-out-of-pocket-drug-cost-arima-model-be-improved-upon" id="toc-univariate-deep-learning-prediction-can-the-out-of-pocket-drug-cost-arima-model-be-improved-upon" class="nav-link active" data-scroll-target="#univariate-deep-learning-prediction-can-the-out-of-pocket-drug-cost-arima-model-be-improved-upon">Univariate Deep Learning Prediction: Can the Out-of-Pocket Drug Cost ARIMA Model be Improved Upon?</a></li>
  <li><a href="#recurrent-neural-network-rnn" id="toc-recurrent-neural-network-rnn" class="nav-link" data-scroll-target="#recurrent-neural-network-rnn">Recurrent Neural Network (RNN)</a></li>
  <li><a href="#gated-recurrent-unit-gru" id="toc-gated-recurrent-unit-gru" class="nav-link" data-scroll-target="#gated-recurrent-unit-gru">Gated Recurrent Unit (GRU)</a></li>
  <li><a href="#long-short-term-memory-lstm" id="toc-long-short-term-memory-lstm" class="nav-link" data-scroll-target="#long-short-term-memory-lstm">Long Short-Term Memory (LSTM)</a></li>
  <li><a href="#neural-network-model-comparison-and-forecasting-are-the-deep-learning-models-reliable" id="toc-neural-network-model-comparison-and-forecasting-are-the-deep-learning-models-reliable" class="nav-link" data-scroll-target="#neural-network-model-comparison-and-forecasting-are-the-deep-learning-models-reliable">Neural Network Model Comparison and Forecasting: Are the Deep Learning Models Reliable?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Deep Learning for TS</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this final section of the project, I am going to begin by applying univariate deep learning prediction methods to the out-of-pocket drug costs time series data I used to perform ARIMA modeling in the ARMA/ARIMA/SARIMA section of this portfolio.</p>
<section id="univariate-deep-learning-prediction-can-the-out-of-pocket-drug-cost-arima-model-be-improved-upon" class="level3">
<h3 class="anchored" data-anchor-id="univariate-deep-learning-prediction-can-the-out-of-pocket-drug-cost-arima-model-be-improved-upon">Univariate Deep Learning Prediction: Can the Out-of-Pocket Drug Cost ARIMA Model be Improved Upon?</h3>
<p>To determine if deep learning can improve the current best ARIMA(1,0,0) model, I am going to fit three types of network models: a Recurrent Neural Network (RNN) model, a Gated Recurrent Unit (GRU) model, and Long Short-Term Memory (LSTM) model.</p>
<p>To do this, I am going to the use the keras package in Python.</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow.keras</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn <span class="im">as</span> sk</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy <span class="im">as</span> sp</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> platform</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Python Platform: </span><span class="sc">{</span>platform<span class="sc">.</span>platform()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tensor Flow Version: </span><span class="sc">{</span>tf<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Keras Version: </span><span class="sc">{</span>tensorflow<span class="sc">.</span>keras<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Python </span><span class="sc">{</span>sys<span class="sc">.</span>version<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Pandas </span><span class="sc">{</span>pd<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Scikit-Learn </span><span class="sc">{</span>sk<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"SciPy </span><span class="sc">{</span>sp<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>gpu <span class="op">=</span> <span class="bu">len</span>(tf.config.list_physical_devices(<span class="st">'GPU'</span>))<span class="op">&gt;</span><span class="dv">0</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"GPU is"</span>, <span class="st">"available"</span> <span class="cf">if</span> gpu <span class="cf">else</span> <span class="st">"NOT AVAILABLE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Python Platform: macOS-13.3.1-arm64-arm-64bit
Tensor Flow Version: 2.12.0
Keras Version: 2.12.0

Python 3.10.10 (main, Mar 21 2023, 13:41:05) [Clang 14.0.6 ]
Pandas 2.0.1
Scikit-Learn 1.2.2
SciPy 1.10.1
GPU is available</code></pre>
</div>
</div>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>drug <span class="op">=</span> pd.read_csv(<span class="st">'./datasets/nhe_drug.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense, SimpleRNN, LSTM ,GRU</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="recurrent-neural-network-rnn" class="level3">
<h3 class="anchored" data-anchor-id="recurrent-neural-network-rnn">Recurrent Neural Network (RNN)</h3>
<p>For the RNN model, the first thing I am going to do is reformat the data into the correct shape for Keras.</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>drug <span class="op">=</span> drug.loc[:, [<span class="st">'Year'</span>, <span class="st">'Out of Pocket'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>drug[<span class="st">'Year'</span>] <span class="op">=</span> pd.to_datetime(drug[<span class="st">'Year'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"%Y"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>drug[<span class="st">'Out of Pocket'</span>] <span class="op">=</span> pd.to_numeric(drug[<span class="st">'Out of Pocket'</span>].<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>drug <span class="op">=</span> drug.set_index(<span class="st">'Year'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To ensure I have more data points to work with while training, I am converting the time series from yearly to monthly.</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>drug_month <span class="op">=</span> drug.resample(<span class="st">'M'</span>).ffill()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, I am going to perform the train-test split, with 80% of the data being used for training.</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_train_test(data, split_percent<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> scaler.fit_transform(data).flatten()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Point for splitting data into train and test</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    split <span class="op">=</span> <span class="bu">int</span>(n<span class="op">*</span>split_percent)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    train_data <span class="op">=</span> data[<span class="bu">range</span>(split)]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    test_data <span class="op">=</span> data[split:]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> train_data, test_data, data</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>train_data, test_data, data <span class="op">=</span> get_train_test(drug_month)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_data.shape)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test_data.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(672,)
(169,)</code></pre>
</div>
</div>
<p>Below, I am visualizing the training-testing split:</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>pio.renderers.default <span class="op">=</span> <span class="st">"plotly_mimetype+notebook_connected"</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plotly_line_plot(t,y,title<span class="op">=</span><span class="st">"Plot"</span>,x_label<span class="op">=</span><span class="st">"Time in Months"</span>,y_label<span class="op">=</span><span class="st">"Y(t): Ratio of Out-of-Pocket Cost"</span>):</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> px.line(x<span class="op">=</span>t[<span class="dv">0</span>],y<span class="op">=</span>y[<span class="dv">0</span>], title<span class="op">=</span>title, render_mode<span class="op">=</span><span class="st">'SVG'</span>)  </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ADD MORE</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="bu">len</span>(y)):</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(t[i])<span class="op">==</span><span class="dv">1</span>:</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(t[i],y[i])</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>            fig.add_scatter(x<span class="op">=</span>t[i],y<span class="op">=</span>y[i])</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>            fig.add_scatter(x<span class="op">=</span>t[i],y<span class="op">=</span>y[i], mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    fig.update_layout(</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>        xaxis_title<span class="op">=</span>x_label,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>        yaxis_title<span class="op">=</span>y_label,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    fig.show()</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>t1<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(train_data))]</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>t2<span class="op">=</span><span class="bu">len</span>(train_data)<span class="op">+</span>np.array([<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(test_data))])</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([t1,t2],[train_data,test_data],title<span class="op">=</span><span class="st">"Out-of-Pocket Drug Costs Since 1960"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="0b5747b5-cb9c-4bf1-a971-5b25ef6be3ef" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("0b5747b5-cb9c-4bf1-a971-5b25ef6be3ef")) {                    Plotly.newPlot(                        "0b5747b5-cb9c-4bf1-a971-5b25ef6be3ef",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671],"xaxis":"x","y":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840],"y":[0.8454112270384213,0.8454112270384213,0.8454112270384213,0.8454112270384213,0.8454112270384213,0.8454112270384213,0.8454112270384213,0.8454112270384213,0.8454112270384213,0.8454112270384213,0.8454112270384213,0.8454112270384213,0.7919862540520433,0.7919862540520433,0.7919862540520433,0.7919862540520433,0.7919862540520433,0.7919862540520433,0.7919862540520433,0.7919862540520433,0.7919862540520433,0.7919862540520433,0.7919862540520433,0.7919862540520433,0.7939879191539865,0.7939879191539865,0.7939879191539865,0.7939879191539865,0.7939879191539865,0.7939879191539865,0.7939879191539865,0.7939879191539865,0.7939879191539865,0.7939879191539865,0.7939879191539865,0.7939879191539865,0.8137034347156041,0.8137034347156041,0.8137034347156041,0.8137034347156041,0.8137034347156041,0.8137034347156041,0.8137034347156041,0.8137034347156041,0.8137034347156041,0.8137034347156041,0.8137034347156041,0.8137034347156041,0.7774608966751103,0.7774608966751103,0.7774608966751103,0.7774608966751103,0.7774608966751103,0.7774608966751103,0.7774608966751103,0.7774608966751103,0.7774608966751103,0.7774608966751103,0.7774608966751103,0.7774608966751103,0.7785591554036101,0.7785591554036101,0.7785591554036101,0.7785591554036101,0.7785591554036101,0.7785591554036101,0.7785591554036101,0.7785591554036101,0.7785591554036101,0.7785591554036101,0.7785591554036101,0.7785591554036101,0.7870795174747135,0.7870795174747135,0.7870795174747135,0.7870795174747135,0.7870795174747135,0.7870795174747135,0.7870795174747135,0.7870795174747135,0.7870795174747135,0.7870795174747135,0.7870795174747135,0.7870795174747135,0.801038031636937,0.801038031636937,0.801038031636937,0.801038031636937,0.801038031636937,0.801038031636937,0.801038031636937,0.801038031636937,0.801038031636937,0.801038031636937,0.801038031636937,0.801038031636937,0.8248985882061184,0.8248985882061184,0.8248985882061184,0.8248985882061184,0.8248985882061184,0.8248985882061184,0.8248985882061184,0.8248985882061184,0.8248985882061184,0.8248985882061184,0.8248985882061184,0.8248985882061184,0.8496802649992029,0.8496802649992029,0.8496802649992029,0.8496802649992029,0.8496802649992029,0.8496802649992029,0.8496802649992029,0.8496802649992029,0.8496802649992029,0.8496802649992029,0.8496802649992029,0.8496802649992029,0.8740368093812552,0.8740368093812552,0.8740368093812552,0.8740368093812552,0.8740368093812552,0.8740368093812552,0.8740368093812552,0.8740368093812552,0.8740368093812552,0.8740368093812552,0.8740368093812552,0.8740368093812552,0.8987122030715817,0.8987122030715817,0.8987122030715817,0.8987122030715817,0.8987122030715817,0.8987122030715817,0.8987122030715817,0.8987122030715817,0.8987122030715817,0.8987122030715817,0.8987122030715817,0.8987122030715817,0.9287726073016491,0.9287726073016491,0.9287726073016491,0.9287726073016491,0.9287726073016491,0.9287726073016491,0.9287726073016491,0.9287726073016491,0.9287726073016491,0.9287726073016491,0.9287726073016491,0.9287726073016491,0.9613838059979098,0.9613838059979098,0.9613838059979098,0.9613838059979098,0.9613838059979098,0.9613838059979098,0.9613838059979098,0.9613838059979098,0.9613838059979098,0.9613838059979098,0.9613838059979098,0.9613838059979098,1.0],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Time in Months"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Y(t): Ratio of Out-of-Pocket Cost"}},"legend":{"tracegroupgap":0},"title":{"text":"Out-of-Pocket Drug Costs Since 1960"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('0b5747b5-cb9c-4bf1-a971-5b25ef6be3ef');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Now that the train-test split has been completed, I will reshape the time series for the Keras model.</p>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PREPARE THE INPUT X AND TARGET Y</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(test_data, p)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(train_data, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below, we can see the shape of the split. Everything looks normal.</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(testX.shape,testY.shape)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainX.shape,trainY.shape)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(trainX))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(16, 9, 1) (16,)
(67, 9, 1) (67,)
&lt;class 'numpy.ndarray'&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Build list </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>tmp1<span class="op">=</span>[]<span class="op">;</span> tmp2<span class="op">=</span>[]<span class="op">;</span> tmp3<span class="op">=</span>[]<span class="op">;</span> count<span class="op">=</span><span class="dv">0</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,trainX.shape[<span class="dv">0</span>]):</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tmp1.append()</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    tmp1.append(count<span class="op">+</span>np.array([<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>,trainX[i,:,<span class="dv">0</span>].shape[<span class="dv">0</span>])]))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    tmp1.append([count<span class="op">+</span>trainX[i,:,<span class="dv">0</span>].shape[<span class="dv">0</span>]])<span class="op">;</span> <span class="co">#print(([count+trainX[i,:,0].shape[0]]))</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tmp1.append([count+trainX[i,:,0].shape[0]+1])</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    tmp2.append(trainX[i,:,<span class="dv">0</span>])</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    tmp2.append([trainY[i]])<span class="op">;</span> <span class="co">#print([trainY[i]])</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tmp2.append([trainY[i]])</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    count<span class="op">+=</span>trainX[i,:,<span class="dv">0</span>].shape[<span class="dv">0</span>]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(i,trainX[i,:,0].shape)</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print(tmp1)</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co"># print(tmp2)</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>plotly_line_plot(tmp1,tmp2,title<span class="op">=</span><span class="st">"Out-of-Pocket Cost: 10-Year Checkpoint Increases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="7b0d5bc5-1452-4056-866f-f76a74271615" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("7b0d5bc5-1452-4056-866f-f76a74271615")) {                    Plotly.newPlot(                        "7b0d5bc5-1452-4056-866f-f76a74271615",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8],"xaxis":"x","y":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],"yaxis":"y","type":"scatter"},{"x":[9],"y":[0.0],"type":"scatter"},{"mode":"lines","x":[10,11,12,13,14,15,16,17,18],"y":[0.0,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.00046056011195153707],"type":"scatter"},{"x":[19],"y":[0.00046056011195153707],"type":"scatter"},{"mode":"lines","x":[20,21,22,23,24,25,26,27,28],"y":[0.00046056011195153707,0.00046056011195153707,0.00046056011195153707,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816],"type":"scatter"},{"x":[29],"y":[0.005668432147095816],"type":"scatter"},{"mode":"lines","x":[30,31,32,33,34,35,36,37,38],"y":[0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.005668432147095816,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722],"type":"scatter"},{"x":[39],"y":[0.007740952650877722],"type":"scatter"},{"mode":"lines","x":[40,41,42,43,44,45,46,47,48],"y":[0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.007740952650877722,0.01011460861247409,0.01011460861247409],"type":"scatter"},{"x":[49],"y":[0.01011460861247409],"type":"scatter"},{"mode":"lines","x":[50,51,52,53,54,55,56,57,58],"y":[0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409,0.01011460861247409],"type":"scatter"},{"x":[59],"y":[0.015517333002674792],"type":"scatter"},{"mode":"lines","x":[60,61,62,63,64,65,66,67,68],"y":[0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792,0.015517333002674792],"type":"scatter"},{"x":[69],"y":[0.015517333002674792],"type":"scatter"},{"mode":"lines","x":[70,71,72,73,74,75,76,77,78],"y":[0.015517333002674792,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653,0.018245265973464653],"type":"scatter"},{"x":[79],"y":[0.018245265973464653],"type":"scatter"},{"mode":"lines","x":[80,81,82,83,84,85,86,87,88],"y":[0.018245265973464653,0.018245265973464653,0.018245265973464653,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584],"type":"scatter"},{"x":[89],"y":[0.020370928028625584],"type":"scatter"},{"mode":"lines","x":[90,91,92,93,94,95,96,97,98],"y":[0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.020370928028625584,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921],"type":"scatter"},{"x":[99],"y":[0.0276336067170921],"type":"scatter"},{"mode":"lines","x":[100,101,102,103,104,105,106,107,108],"y":[0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.0276336067170921,0.03195578622925266,0.03195578622925266],"type":"scatter"},{"x":[109],"y":[0.03195578622925266],"type":"scatter"},{"mode":"lines","x":[110,111,112,113,114,115,116,117,118],"y":[0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266,0.03195578622925266],"type":"scatter"},{"x":[119],"y":[0.03496714080739731],"type":"scatter"},{"mode":"lines","x":[120,121,122,123,124,125,126,127,128],"y":[0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731,0.03496714080739731],"type":"scatter"},{"x":[129],"y":[0.03496714080739731],"type":"scatter"},{"mode":"lines","x":[130,131,132,133,134,135,136,137,138],"y":[0.03496714080739731,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047,0.0389173294599047],"type":"scatter"},{"x":[139],"y":[0.0389173294599047],"type":"scatter"},{"mode":"lines","x":[140,141,142,143,144,145,146,147,148],"y":[0.0389173294599047,0.0389173294599047,0.0389173294599047,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191],"type":"scatter"},{"x":[149],"y":[0.04396577684091191],"type":"scatter"},{"mode":"lines","x":[150,151,152,153,154,155,156,157,158],"y":[0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.04396577684091191,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306],"type":"scatter"},{"x":[159],"y":[0.049439356632951306],"type":"scatter"},{"mode":"lines","x":[160,161,162,163,164,165,166,167,168],"y":[0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.049439356632951306,0.05627690291038563,0.05627690291038563],"type":"scatter"},{"x":[169],"y":[0.05627690291038563],"type":"scatter"},{"mode":"lines","x":[170,171,172,173,174,175,176,177,178],"y":[0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563,0.05627690291038563],"type":"scatter"},{"x":[179],"y":[0.06284874143092484],"type":"scatter"},{"mode":"lines","x":[180,181,182,183,184,185,186,187,188],"y":[0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484,0.06284874143092484],"type":"scatter"},{"x":[189],"y":[0.06284874143092484],"type":"scatter"},{"mode":"lines","x":[190,191,192,193,194,195,196,197,198],"y":[0.06284874143092484,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07044798327812517],"type":"scatter"},{"x":[199],"y":[0.07044798327812517],"type":"scatter"},{"mode":"lines","x":[200,201,202,203,204,205,206,207,208],"y":[0.07044798327812517,0.07044798327812517,0.07044798327812517,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782],"type":"scatter"},{"x":[209],"y":[0.07574442456556782],"type":"scatter"},{"mode":"lines","x":[210,211,212,213,214,215,216,217,218],"y":[0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.07574442456556782,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602],"type":"scatter"},{"x":[219],"y":[0.0826882539457602],"type":"scatter"},{"mode":"lines","x":[220,221,222,223,224,225,226,227,228],"y":[0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.0826882539457602,0.08934866171859777,0.08934866171859777],"type":"scatter"},{"x":[229],"y":[0.08934866171859777],"type":"scatter"},{"mode":"lines","x":[230,231,232,233,234,235,236,237,238],"y":[0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777,0.08934866171859777],"type":"scatter"},{"x":[239],"y":[0.10766478309390111],"type":"scatter"},{"mode":"lines","x":[240,241,242,243,244,245,246,247,248],"y":[0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111,0.10766478309390111],"type":"scatter"},{"x":[249],"y":[0.10766478309390111],"type":"scatter"},{"mode":"lines","x":[250,251,252,253,254,255,256,257,258],"y":[0.10766478309390111,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447,0.11455547092271447],"type":"scatter"},{"x":[259],"y":[0.11455547092271447],"type":"scatter"},{"mode":"lines","x":[260,261,262,263,264,265,266,267,268],"y":[0.11455547092271447,0.11455547092271447,0.11455547092271447,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923],"type":"scatter"},{"x":[269],"y":[0.1407896834534923],"type":"scatter"},{"mode":"lines","x":[270,271,272,273,274,275,276,277,278],"y":[0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.1407896834534923,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217],"type":"scatter"},{"x":[279],"y":[0.15875152781960217],"type":"scatter"},{"mode":"lines","x":[280,281,282,283,284,285,286,287,288],"y":[0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.15875152781960217,0.18179724726763857,0.18179724726763857],"type":"scatter"},{"x":[289],"y":[0.18179724726763857],"type":"scatter"},{"mode":"lines","x":[290,291,292,293,294,295,296,297,298],"y":[0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857,0.18179724726763857],"type":"scatter"},{"x":[299],"y":[0.20167218748339327],"type":"scatter"},{"mode":"lines","x":[300,301,302,303,304,305,306,307,308],"y":[0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327,0.20167218748339327],"type":"scatter"},{"x":[309],"y":[0.20167218748339327],"type":"scatter"},{"mode":"lines","x":[310,311,312,313,314,315,316,317,318],"y":[0.20167218748339327,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818,0.23568278036596818],"type":"scatter"},{"x":[319],"y":[0.23568278036596818],"type":"scatter"},{"mode":"lines","x":[320,321,322,323,324,325,326,327,328],"y":[0.23568278036596818,0.23568278036596818,0.23568278036596818,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203],"type":"scatter"},{"x":[329],"y":[0.25288292916231203],"type":"scatter"},{"mode":"lines","x":[330,331,332,333,334,335,336,337,338],"y":[0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.25288292916231203,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898],"type":"scatter"},{"x":[339],"y":[0.2889129009972898],"type":"scatter"},{"mode":"lines","x":[340,341,342,343,344,345,346,347,348],"y":[0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.2889129009972898,0.32294120773032436,0.32294120773032436],"type":"scatter"},{"x":[349],"y":[0.32294120773032436],"type":"scatter"},{"mode":"lines","x":[350,351,352,353,354,355,356,357,358],"y":[0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436,0.32294120773032436],"type":"scatter"},{"x":[359],"y":[0.36414362389952704],"type":"scatter"},{"mode":"lines","x":[360,361,362,363,364,365,366,367,368],"y":[0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704,0.36414362389952704],"type":"scatter"},{"x":[369],"y":[0.36414362389952704],"type":"scatter"},{"mode":"lines","x":[370,371,372,373,374,375,376,377,378],"y":[0.36414362389952704,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3765610330717588],"type":"scatter"},{"x":[379],"y":[0.3765610330717588],"type":"scatter"},{"mode":"lines","x":[380,381,382,383,384,385,386,387,388],"y":[0.3765610330717588,0.3765610330717588,0.3765610330717588,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778],"type":"scatter"},{"x":[389],"y":[0.3787929782296778],"type":"scatter"},{"mode":"lines","x":[390,391,392,393,394,395,396,397,398],"y":[0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.3787929782296778,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845],"type":"scatter"},{"x":[399],"y":[0.38637450622641845],"type":"scatter"},{"mode":"lines","x":[400,401,402,403,404,405,406,407,408],"y":[0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.38637450622641845,0.37509078348360586,0.37509078348360586],"type":"scatter"},{"x":[409],"y":[0.37509078348360586],"type":"scatter"},{"mode":"lines","x":[410,411,412,413,414,415,416,417,418],"y":[0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586,0.37509078348360586],"type":"scatter"},{"x":[419],"y":[0.37608275910934763],"type":"scatter"},{"mode":"lines","x":[420,421,422,423,424,425,426,427,428],"y":[0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763,0.37608275910934763],"type":"scatter"},{"x":[429],"y":[0.37608275910934763],"type":"scatter"},{"mode":"lines","x":[430,431,432,433,434,435,436,437,438],"y":[0.37608275910934763,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675,0.39245035693408675],"type":"scatter"},{"x":[439],"y":[0.39245035693408675],"type":"scatter"},{"mode":"lines","x":[440,441,442,443,444,445,446,447,448],"y":[0.39245035693408675,0.39245035693408675,0.39245035693408675,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937],"type":"scatter"},{"x":[449],"y":[0.4181885816519937],"type":"scatter"},{"mode":"lines","x":[450,451,452,453,454,455,456,457,458],"y":[0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4181885816519937,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605],"type":"scatter"},{"x":[459],"y":[0.4526420207960605],"type":"scatter"},{"mode":"lines","x":[460,461,462,463,464,465,466,467,468],"y":[0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.4526420207960605,0.5113811489203408,0.5113811489203408],"type":"scatter"},{"x":[469],"y":[0.5113811489203408],"type":"scatter"},{"mode":"lines","x":[470,471,472,473,474,475,476,477,478],"y":[0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408,0.5113811489203408],"type":"scatter"},{"x":[479],"y":[0.5697128584840487],"type":"scatter"},{"mode":"lines","x":[480,481,482,483,484,485,486,487,488],"y":[0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487,0.5697128584840487],"type":"scatter"},{"x":[489],"y":[0.5697128584840487],"type":"scatter"},{"mode":"lines","x":[490,491,492,493,494,495,496,497,498],"y":[0.5697128584840487,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583,0.62296069296583],"type":"scatter"},{"x":[499],"y":[0.62296069296583],"type":"scatter"},{"mode":"lines","x":[500,501,502,503,504,505,506,507,508],"y":[0.62296069296583,0.62296069296583,0.62296069296583,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568],"type":"scatter"},{"x":[509],"y":[0.7596939046640568],"type":"scatter"},{"mode":"lines","x":[510,511,512,513,514,515,516,517,518],"y":[0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.7596939046640568,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316],"type":"scatter"},{"x":[519],"y":[0.8415850353391316],"type":"scatter"},{"mode":"lines","x":[520,521,522,523,524,525,526,527,528],"y":[0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8415850353391316,0.8863125077498096,0.8863125077498096],"type":"scatter"},{"x":[529],"y":[0.8863125077498096],"type":"scatter"},{"mode":"lines","x":[530,531,532,533,534,535,536,537,538],"y":[0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096,0.8863125077498096],"type":"scatter"},{"x":[539],"y":[0.9420934228473243],"type":"scatter"},{"mode":"lines","x":[540,541,542,543,544,545,546,547,548],"y":[0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243,0.9420934228473243],"type":"scatter"},{"x":[549],"y":[0.9420934228473243],"type":"scatter"},{"mode":"lines","x":[550,551,552,553,554,555,556,557,558],"y":[0.9420934228473243,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9549891059819673],"type":"scatter"},{"x":[559],"y":[0.9549891059819673],"type":"scatter"},{"mode":"lines","x":[560,561,562,563,564,565,566,567,568],"y":[0.9549891059819673,0.9549891059819673,0.9549891059819673,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341],"type":"scatter"},{"x":[569],"y":[0.9600552672134341],"type":"scatter"},{"mode":"lines","x":[570,571,572,573,574,575,576,577,578],"y":[0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9600552672134341,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449],"type":"scatter"},{"x":[579],"y":[0.9159477795688449],"type":"scatter"},{"mode":"lines","x":[580,581,582,583,584,585,586,587,588],"y":[0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.9159477795688449,0.8699980514764495,0.8699980514764495],"type":"scatter"},{"x":[589],"y":[0.8699980514764495],"type":"scatter"},{"mode":"lines","x":[590,591,592,593,594,595,596,597,598],"y":[0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495,0.8699980514764495],"type":"scatter"},{"x":[599],"y":[0.8000991975625742],"type":"scatter"},{"mode":"lines","x":[600,601,602,603,604,605,606,607,608],"y":[0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742,0.8000991975625742],"type":"scatter"},{"x":[609],"y":[0.8000991975625742],"type":"scatter"},{"mode":"lines","x":[610,611,612,613,614,615,616,617,618],"y":[0.8000991975625742,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7563459869271784],"type":"scatter"},{"x":[619],"y":[0.7563459869271784],"type":"scatter"},{"mode":"lines","x":[620,621,622,623,624,625,626,627,628],"y":[0.7563459869271784,0.7563459869271784,0.7563459869271784,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288],"type":"scatter"},{"x":[629],"y":[0.7536003401059288],"type":"scatter"},{"mode":"lines","x":[630,631,632,633,634,635,636,637,638],"y":[0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7536003401059288,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157],"type":"scatter"},{"x":[639],"y":[0.7456113935486157],"type":"scatter"},{"mode":"lines","x":[640,641,642,643,644,645,646,647,648],"y":[0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.7456113935486157,0.8144651302853702,0.8144651302853702],"type":"scatter"},{"x":[649],"y":[0.8144651302853702],"type":"scatter"},{"mode":"lines","x":[650,651,652,653,654,655,656,657,658],"y":[0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702,0.8144651302853702],"type":"scatter"},{"x":[659],"y":[0.8757550528758437],"type":"scatter"},{"mode":"lines","x":[660,661,662,663,664,665,666,667,668],"y":[0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437,0.8757550528758437],"type":"scatter"},{"x":[669],"y":[0.8757550528758437],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Time in Months"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Y(t): Ratio of Out-of-Pocket Cost"}},"legend":{"tracegroupgap":0},"title":{"text":"Out-of-Pocket Cost: 10-Year Checkpoint Increases"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('7b0d5bc5-1452-4056-866f-f76a74271615');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<section id="creating-the-rnn-model" class="level4">
<h4 class="anchored" data-anchor-id="creating-the-rnn-model">Creating the RNN Model</h4>
<p>First, I am going to establish the parameters. I will be using 3 recurrent hidden units, 200 epochs, and fraction batch size of 0.2, and a validation split of 0.2. The results of this are seen below.</p>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">200</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainX.shape,p,trainY.shape)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p,trainX.shape,testX.shape,trainY.shape,testY.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(67, 9, 1) 10 (67,)
10 (67, 9, 1) (16, 9, 1) (67,) (16,)</code></pre>
</div>
</div>
<p>Now, I will create and run the RNN model. I will also add regularization to the model.</p>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> regularizers</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>drug_rnn <span class="op">=</span> Sequential()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>drug_rnn.add(SimpleRNN(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    recurrent_hidden_units,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># recurrent_dropout=0.8,</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>          ) </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>drug_rnn.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>drug_rnn.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>drug_rnn.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Metal device set to: Apple M2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Layer (type)                Output Shape              Param #   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> simple_rnn (SimpleRNN)      (None, 3)                 15        </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense (Dense)               (None, 1)                 4         </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total params: 19</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Trainable params: 19</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-trainable params: 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
</div>
<p>Now that the model is created, I will begin the training process.</p>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">73</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> drug_rnn.fit(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-02 01:07:33.159170: W tensorflow/tsl/platform/profile_utils/cpu_utils.cc:128] Failed to get CPU frequency: 0 Hz</code></pre>
</div>
</div>
<p>The fitting history can now be visualized to see how the model learned over time and decreased its validation loss as it improved.</p>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> drug_rnn.predict(trainX).squeeze()</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> drug_rnn.predict(testX).squeeze()</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainY.shape, train_predict.shape)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean((trainY<span class="op">-</span>train_predict)<span class="op">**</span><span class="fl">2.0</span>))</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean((testY<span class="op">-</span>test_predict)<span class="op">**</span><span class="fl">2.0</span>))</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse<span class="op">**</span><span class="fl">2.0</span>,train_rmse))</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse<span class="op">**</span><span class="fl">2.0</span>,test_rmse))    </span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Montly Out-of-Pocket Drug Cost Since 1960"</span>,x_label<span class="op">=</span><span class="st">"training epochs"</span>,y_label<span class="op">=</span><span class="st">"loss (MSE)"</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(history.history[<span class="st">'loss'</span>])</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="co"># SIMPLE PLOT </span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs_steps, history.history[<span class="st">'loss'</span>], <span class="st">'bo'</span>, label<span class="op">=</span><span class="st">'Training loss'</span>)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs_steps, history.history[<span class="st">'val_loss'</span>], <span class="st">'b'</span>, label<span class="op">=</span><span class="st">'Validation loss'</span>)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1/3 [=========&gt;....................] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>3/3 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>3/3 [==============================] - 0s 35ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 69ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(67, 9, 1) (67,) (67,) (16, 9, 1) (16,) (16,)
(67,) (67,)
0.0004908836711537983
0.0007197042005554613
Train MSE = 0.00049 RMSE = 0.02216
Test MSE = 0.00072 RMSE = 0.02683</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="a8fc1eb4-a7d2-4f72-b2a5-633eb622284c" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a8fc1eb4-a7d2-4f72-b2a5-633eb622284c")) {                    Plotly.newPlot(                        "a8fc1eb4-a7d2-4f72-b2a5-633eb622284c",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.09603670239448547,0.08483456820249557,0.07905453443527222,0.07448507845401764,0.07062412798404694,0.06710965186357498,0.06334959715604782,0.06063743308186531,0.05814851075410843,0.05576016753911972,0.053056128323078156,0.05129432678222656,0.049916770309209824,0.04894070699810982,0.048160579055547714,0.04710451140999794,0.04543609172105789,0.0447278656065464,0.04415449500083923,0.04366106912493706,0.04276585578918457,0.04202517494559288,0.04127328842878342,0.04056882858276367,0.03997688367962837,0.03935287147760391,0.03874776139855385,0.03811287134885788,0.03732256218791008,0.036645352840423584,0.03616262227296829,0.035403329879045486,0.03517269343137741,0.03427896648645401,0.03386112302541733,0.03341228514909744,0.03282812610268593,0.03258143365383148,0.032249026000499725,0.031964801251888275,0.03166532143950462,0.031279999762773514,0.031020790338516235,0.03058524802327156,0.030246054753661156,0.029884805902838707,0.029352830722928047,0.028970738872885704,0.028681213036179543,0.028421955183148384,0.028120340779423714,0.027842221781611443,0.027677277103066444,0.02728920616209507,0.026912394911050797,0.02657177485525608,0.026142898947000504,0.0257425494492054,0.025294972583651543,0.025022709742188454,0.024606386199593544,0.024319898337125778,0.023795440793037415,0.023457443341612816,0.02307666279375553,0.022739363834261894,0.022392671555280685,0.022167295217514038,0.02165834791958332,0.0213344544172287,0.02100096084177494,0.020755941048264503,0.020328009501099586,0.02007332630455494,0.019675830379128456,0.019378770142793655,0.0191542636603117,0.01878931000828743,0.018549321219325066,0.018170004710555077,0.017893003299832344,0.01759549230337143,0.01730422116816044,0.01702715829014778,0.016784681007266045,0.01648884080350399,0.016323676332831383,0.015995493158698082,0.01577814295887947,0.015454746782779694,0.015363226644694805,0.015178892761468887,0.014899145811796188,0.014643626287579536,0.01438691932708025,0.01417434960603714,0.013931430876255035,0.013688196428120136,0.013509531505405903,0.013209164142608643,0.013037504628300667,0.012737646698951721,0.01255673635751009,0.012329734861850739,0.012107811868190765,0.011881297454237938,0.01170127373188734,0.01148591935634613,0.011275031603872776,0.011124897748231888,0.010955989360809326,0.010705629363656044,0.010600118897855282,0.0103666502982378,0.010120178572833538,0.00993245281279087,0.009782298468053341,0.009575190022587776,0.009391915053129196,0.00918111577630043,0.009060665033757687,0.008898471482098103,0.008699659258127213,0.00852557085454464,0.008441745303571224,0.008271463215351105,0.008075482212007046,0.007944933138787746,0.007740739732980728,0.007580621168017387,0.007450016215443611,0.007276552263647318,0.007207680959254503,0.007011267822235823,0.006895897909998894,0.006725126411765814,0.006590708624571562,0.00643808813765645,0.006285918410867453,0.0061828624457120895,0.006027578841894865,0.005872515495866537,0.0057489899918437,0.005728605203330517,0.005527694243937731,0.005380368325859308,0.005253085400909185,0.0051521072164177895,0.005000610835850239,0.004913466051220894,0.004778190050274134,0.0047745173797011375,0.004666854627430439,0.0045823291875422,0.004507612902671099,0.004431066568940878,0.004347397014498711,0.004264363087713718,0.004183647688478231,0.0040575130842626095,0.003990067169070244,0.003851810935884714,0.0038757130969315767,0.0037244006525725126,0.003650324186310172,0.0035725547932088375,0.003491828450933099,0.0033966521732509136,0.003301351796835661,0.0032862243242561817,0.0031485799700021744,0.003072346094995737,0.0029764496721327305,0.0029170585330575705,0.002835181774571538,0.002796524204313755,0.0027162213809788227,0.0026535915676504374,0.0026766713708639145,0.0025921084452420473,0.002537062391638756,0.0024805283173918724,0.002426774939522147,0.0023782742209732533,0.002331819385290146,0.0022456750739365816,0.002175071043893695,0.0021182363852858543,0.002040459541603923,0.0019978678319603205,0.0019211899489164352,0.0018539037555456161,0.001788346329703927,0.0017415083711966872,0.0016822252655401826,0.001645833719521761,0.0015721700619906187,0.0015193807194009423,0.0014674306148663163,0.001419237582013011],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.6308571696281433,0.586304247379303,0.5474891662597656,0.5242693424224854,0.49615082144737244,0.45772919058799744,0.4427369236946106,0.42069047689437866,0.40071386098861694,0.3662300109863281,0.34298911690711975,0.33623889088630676,0.32314735651016235,0.31634992361068726,0.29882973432540894,0.27628234028816223,0.26786595582962036,0.26793012022972107,0.2646145522594452,0.253802090883255,0.24107317626476288,0.23275060951709747,0.22446267306804657,0.2263028621673584,0.219944566488266,0.21884354948997498,0.21196970343589783,0.20015867054462433,0.19628310203552246,0.18890880048274994,0.18132758140563965,0.1778026670217514,0.17161083221435547,0.16470959782600403,0.16758538782596588,0.14788129925727844,0.1475812941789627,0.14726698398590088,0.14193718135356903,0.1459663361310959,0.13698787987232208,0.14170806109905243,0.1359679102897644,0.13476400077342987,0.13390816748142242,0.12905430793762207,0.11239039152860641,0.11559919267892838,0.11472087353467941,0.11423336714506149,0.11254091560840607,0.11686346679925919,0.11774325370788574,0.11314808577299118,0.10966016352176666,0.10605760663747787,0.10189805179834366,0.10023800283670425,0.10212357342243195,0.09538130462169647,0.09654761105775833,0.09023214131593704,0.0904441699385643,0.07642503082752228,0.07728813588619232,0.08095038682222366,0.08038115501403809,0.07240762561559677,0.07094167917966843,0.06999664008617401,0.06638988107442856,0.06534098088741302,0.06495759636163712,0.06312620639801025,0.06279481947422028,0.06527034193277359,0.05882515385746956,0.06048807501792908,0.056809842586517334,0.0551752969622612,0.05139544978737831,0.04865730553865433,0.05320924147963524,0.04762644320726395,0.04685748368501663,0.04696386307477951,0.04416899010539055,0.047687094658613205,0.039367370307445526,0.044243305921554565,0.044941335916519165,0.04153865575790405,0.03849237039685249,0.038931071758270264,0.03611642122268677,0.03526880964636803,0.0343664214015007,0.03323812410235405,0.033132802695035934,0.030305009335279465,0.02985657937824726,0.02971896156668663,0.02816343866288662,0.027343373745679855,0.023968981578946114,0.029093023389577866,0.026142975315451622,0.024411756545305252,0.027596959844231606,0.027496332302689552,0.024806201457977295,0.026430992409586906,0.026091068983078003,0.022059395909309387,0.0208957027643919,0.022888148203492165,0.01874060556292534,0.01761070266366005,0.018913280218839645,0.018038177862763405,0.020160961896181107,0.018616747111082077,0.017589950934052467,0.019326014444231987,0.01888457126915455,0.01626228168606758,0.01651211641728878,0.01532041747123003,0.01533634401857853,0.014518404379487038,0.012908844277262688,0.016162633895874023,0.013824759051203728,0.014692462980747223,0.013392091728746891,0.011195431463420391,0.01155595388263464,0.012245768681168556,0.010968747548758984,0.01169663481414318,0.010080541484057903,0.010413763113319874,0.0083774384111166,0.01090907584875822,0.010215559042990208,0.009724254719913006,0.009385752491652966,0.009205827489495277,0.00823945552110672,0.008063486777245998,0.006577713880687952,0.007105657365173101,0.008153310045599937,0.00858414638787508,0.008271926082670689,0.007743548136204481,0.007739505730569363,0.008771473541855812,0.007512399461120367,0.007489179261028767,0.007377090863883495,0.005133951548486948,0.006183459889143705,0.006328296847641468,0.006420391611754894,0.006696547847241163,0.006258692126721144,0.005887981038540602,0.007085250224918127,0.0059792459942400455,0.006443861871957779,0.006107761524617672,0.006465880665928125,0.0059328461065888405,0.004010783042758703,0.004973651375621557,0.004893769044429064,0.0037588158156722784,0.004128067754209042,0.004301759414374828,0.004615883342921734,0.004704796243458986,0.005252246279269457,0.0046319211833179,0.004218304064124823,0.004409645218402147,0.0049026296474039555,0.003973540849983692,0.004704297054558992,0.004067064728587866,0.003712845966219902,0.00370584474876523,0.004418511874973774,0.0034471736289560795,0.002661177422851324,0.003200958017259836,0.0029347368981689215,0.0029909543227404356,0.0031252324115484953,0.00308146676979959],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Montly Out-of-Pocket Drug Cost Since 1960"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a8fc1eb4-a7d2-4f72-b2a5-633eb622284c');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.09603670239448547, 0.08483456820249557, 0.07905453443527222, 0.07448507845401764, 0.07062412798404694, 0.06710965186357498, 0.06334959715604782, 0.06063743308186531, 0.05814851075410843, 0.05576016753911972, 0.053056128323078156, 0.05129432678222656, 0.049916770309209824, 0.04894070699810982, 0.048160579055547714, 0.04710451140999794, 0.04543609172105789, 0.0447278656065464, 0.04415449500083923, 0.04366106912493706, 0.04276585578918457, 0.04202517494559288, 0.04127328842878342, 0.04056882858276367, 0.03997688367962837, 0.03935287147760391, 0.03874776139855385, 0.03811287134885788, 0.03732256218791008, 0.036645352840423584, 0.03616262227296829, 0.035403329879045486, 0.03517269343137741, 0.03427896648645401, 0.03386112302541733, 0.03341228514909744, 0.03282812610268593, 0.03258143365383148, 0.032249026000499725, 0.031964801251888275, 0.03166532143950462, 0.031279999762773514, 0.031020790338516235, 0.03058524802327156, 0.030246054753661156, 0.029884805902838707, 0.029352830722928047, 0.028970738872885704, 0.028681213036179543, 0.028421955183148384, 0.028120340779423714, 0.027842221781611443, 0.027677277103066444, 0.02728920616209507, 0.026912394911050797, 0.02657177485525608, 0.026142898947000504, 0.0257425494492054, 0.025294972583651543, 0.025022709742188454, 0.024606386199593544, 0.024319898337125778, 0.023795440793037415, 0.023457443341612816, 0.02307666279375553, 0.022739363834261894, 0.022392671555280685, 0.022167295217514038, 0.02165834791958332, 0.0213344544172287, 0.02100096084177494, 0.020755941048264503, 0.020328009501099586, 0.02007332630455494, 0.019675830379128456, 0.019378770142793655, 0.0191542636603117, 0.01878931000828743, 0.018549321219325066, 0.018170004710555077, 0.017893003299832344, 0.01759549230337143, 0.01730422116816044, 0.01702715829014778, 0.016784681007266045, 0.01648884080350399, 0.016323676332831383, 0.015995493158698082, 0.01577814295887947, 0.015454746782779694, 0.015363226644694805, 0.015178892761468887, 0.014899145811796188, 0.014643626287579536, 0.01438691932708025, 0.01417434960603714, 0.013931430876255035, 0.013688196428120136, 0.013509531505405903, 0.013209164142608643, 0.013037504628300667, 0.012737646698951721, 0.01255673635751009, 0.012329734861850739, 0.012107811868190765, 0.011881297454237938, 0.01170127373188734, 0.01148591935634613, 0.011275031603872776, 0.011124897748231888, 0.010955989360809326, 0.010705629363656044, 0.010600118897855282, 0.0103666502982378, 0.010120178572833538, 0.00993245281279087, 0.009782298468053341, 0.009575190022587776, 0.009391915053129196, 0.00918111577630043, 0.009060665033757687, 0.008898471482098103, 0.008699659258127213, 0.00852557085454464, 0.008441745303571224, 0.008271463215351105, 0.008075482212007046, 0.007944933138787746, 0.007740739732980728, 0.007580621168017387, 0.007450016215443611, 0.007276552263647318, 0.007207680959254503, 0.007011267822235823, 0.006895897909998894, 0.006725126411765814, 0.006590708624571562, 0.00643808813765645, 0.006285918410867453, 0.0061828624457120895, 0.006027578841894865, 0.005872515495866537, 0.0057489899918437, 0.005728605203330517, 0.005527694243937731, 0.005380368325859308, 0.005253085400909185, 0.0051521072164177895, 0.005000610835850239, 0.004913466051220894, 0.004778190050274134, 0.0047745173797011375, 0.004666854627430439, 0.0045823291875422, 0.004507612902671099, 0.004431066568940878, 0.004347397014498711, 0.004264363087713718, 0.004183647688478231, 0.0040575130842626095, 0.003990067169070244, 0.003851810935884714, 0.0038757130969315767, 0.0037244006525725126, 0.003650324186310172, 0.0035725547932088375, 0.003491828450933099, 0.0033966521732509136, 0.003301351796835661, 0.0032862243242561817, 0.0031485799700021744, 0.003072346094995737, 0.0029764496721327305, 0.0029170585330575705, 0.002835181774571538, 0.002796524204313755, 0.0027162213809788227, 0.0026535915676504374, 0.0026766713708639145, 0.0025921084452420473, 0.002537062391638756, 0.0024805283173918724, 0.002426774939522147, 0.0023782742209732533, 0.002331819385290146, 0.0022456750739365816, 0.002175071043893695, 0.0021182363852858543, 0.002040459541603923, 0.0019978678319603205, 0.0019211899489164352, 0.0018539037555456161, 0.001788346329703927, 0.0017415083711966872, 0.0016822252655401826, 0.001645833719521761, 0.0015721700619906187, 0.0015193807194009423, 0.0014674306148663163, 0.001419237582013011]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>&lt;matplotlib.legend.Legend at 0x296022920&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deep-learning_files/figure-html/cell-17-output-10.png" width="571" height="411"></p>
</div>
</div>
<p>Above, we can see how the training and validation loss decrease over time. Although it looks messy, we can see that the validation loss is extremely small, and is decreasing over time. By 200 epochs, it is nearing 0.001.</p>
<p>This can also been seen by looking at a parity plot of the predicted out-of-pocket drug cost agains the real out-of-pocket drug cost. Overall, it looks like the model is successfully predicting true out-of-pocket cost values!</p>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY,y<span class="op">=</span>train_predict,height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY,y<span class="op">=</span>test_predict,mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY,y<span class="op">=</span>trainY, mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="6f4b3da7-3a0e-431e-aefa-a3f8ce7de2bd" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("6f4b3da7-3a0e-431e-aefa-a3f8ce7de2bd")) {                    Plotly.newPlot(                        "6f4b3da7-3a0e-431e-aefa-a3f8ce7de2bd",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[0.0,0.00046056011195153707,0.005668432147095816,0.007740952650877722,0.01011460861247409,0.015517333002674792,0.015517333002674792,0.018245265973464653,0.020370928028625584,0.0276336067170921,0.03195578622925266,0.03496714080739731,0.03496714080739731,0.0389173294599047,0.04396577684091191,0.049439356632951306,0.05627690291038563,0.06284874143092484,0.06284874143092484,0.07044798327812517,0.07574442456556782,0.0826882539457602,0.08934866171859777,0.10766478309390111,0.10766478309390111,0.11455547092271447,0.1407896834534923,0.15875152781960217,0.18179724726763857,0.20167218748339327,0.20167218748339327,0.23568278036596818,0.25288292916231203,0.2889129009972898,0.32294120773032436,0.36414362389952704,0.36414362389952704,0.3765610330717588,0.3787929782296778,0.38637450622641845,0.37509078348360586,0.37608275910934763,0.37608275910934763,0.39245035693408675,0.4181885816519937,0.4526420207960605,0.5113811489203408,0.5697128584840487,0.5697128584840487,0.62296069296583,0.7596939046640568,0.8415850353391316,0.8863125077498096,0.9420934228473243,0.9420934228473243,0.9549891059819673,0.9600552672134341,0.9159477795688449,0.8699980514764495,0.8000991975625742,0.8000991975625742,0.7563459869271784,0.7536003401059288,0.7456113935486157,0.8144651302853702,0.8757550528758437,0.8757550528758437],"xaxis":"x","y":[-0.0006367862224578857,-0.00018477439880371094,0.0049303025007247925,0.006962299346923828,0.009072735905647278,0.009304821491241455,0.014627844095230103,0.01731887459754944,0.019417062401771545,0.026573047041893005,0.030447840690612793,0.030876517295837402,0.0338614284992218,0.03778076171875,0.04279537498950958,0.04822303354740143,0.054366499185562134,0.055054426193237305,0.06161406636238098,0.06921251118183136,0.07451605051755905,0.08145680278539658,0.08748790621757507,0.08817027509212494,0.10661625117063522,0.11357323825359344,0.1401357650756836,0.15832796692848206,0.17943249642848969,0.1818740963935852,0.20217160880565643,0.236973837018013,0.25459182262420654,0.2913784384727478,0.3226854205131531,0.32633429765701294,0.36837369203567505,0.3810030519962311,0.3832704424858093,0.39094114303588867,0.38070589303970337,0.3795088827610016,0.3805170953273773,0.39712953567504883,0.42315518856048584,0.45767027139663696,0.5102153420448303,0.5161253213882446,0.5729904770851135,0.6237932443618774,0.7484716176986694,0.8184950351715088,0.8524161577224731,0.8554370403289795,0.8997473120689392,0.9097409844398499,0.9136411547660828,0.8792635202407837,0.8452056646347046,0.8421475291252136,0.7835499048233032,0.7455372214317322,0.7431186437606812,0.736076831817627,0.79062420129776,0.7958099842071533,0.8468540906906128],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[0.8454112270384213,0.7919862540520433,0.7939879191539865,0.8137034347156041,0.7774608966751103,0.7785591554036101,0.7785591554036101,0.7870795174747135,0.801038031636937,0.8248985882061184,0.8496802649992029,0.8740368093812552,0.8740368093812552,0.8987122030715817,0.9287726073016491,0.9613838059979098],"y":[0.8218405246734619,0.7765775322914124,0.7783008813858032,0.7951239347457886,0.7667612433433533,0.764007031917572,0.764961302280426,0.7723435759544373,0.7843536734580994,0.8045985102653503,0.8236410021781921,0.8253903985023499,0.8454512357711792,0.8654382824897766,0.8893241286277771,0.9146159291267395],"type":"scatter"},{"mode":"lines","x":[0.0,0.00046056011195153707,0.005668432147095816,0.007740952650877722,0.01011460861247409,0.015517333002674792,0.015517333002674792,0.018245265973464653,0.020370928028625584,0.0276336067170921,0.03195578622925266,0.03496714080739731,0.03496714080739731,0.0389173294599047,0.04396577684091191,0.049439356632951306,0.05627690291038563,0.06284874143092484,0.06284874143092484,0.07044798327812517,0.07574442456556782,0.0826882539457602,0.08934866171859777,0.10766478309390111,0.10766478309390111,0.11455547092271447,0.1407896834534923,0.15875152781960217,0.18179724726763857,0.20167218748339327,0.20167218748339327,0.23568278036596818,0.25288292916231203,0.2889129009972898,0.32294120773032436,0.36414362389952704,0.36414362389952704,0.3765610330717588,0.3787929782296778,0.38637450622641845,0.37509078348360586,0.37608275910934763,0.37608275910934763,0.39245035693408675,0.4181885816519937,0.4526420207960605,0.5113811489203408,0.5697128584840487,0.5697128584840487,0.62296069296583,0.7596939046640568,0.8415850353391316,0.8863125077498096,0.9420934228473243,0.9420934228473243,0.9549891059819673,0.9600552672134341,0.9159477795688449,0.8699980514764495,0.8000991975625742,0.8000991975625742,0.7563459869271784,0.7536003401059288,0.7456113935486157,0.8144651302853702,0.8757550528758437,0.8757550528758437],"y":[0.0,0.00046056011195153707,0.005668432147095816,0.007740952650877722,0.01011460861247409,0.015517333002674792,0.015517333002674792,0.018245265973464653,0.020370928028625584,0.0276336067170921,0.03195578622925266,0.03496714080739731,0.03496714080739731,0.0389173294599047,0.04396577684091191,0.049439356632951306,0.05627690291038563,0.06284874143092484,0.06284874143092484,0.07044798327812517,0.07574442456556782,0.0826882539457602,0.08934866171859777,0.10766478309390111,0.10766478309390111,0.11455547092271447,0.1407896834534923,0.15875152781960217,0.18179724726763857,0.20167218748339327,0.20167218748339327,0.23568278036596818,0.25288292916231203,0.2889129009972898,0.32294120773032436,0.36414362389952704,0.36414362389952704,0.3765610330717588,0.3787929782296778,0.38637450622641845,0.37509078348360586,0.37608275910934763,0.37608275910934763,0.39245035693408675,0.4181885816519937,0.4526420207960605,0.5113811489203408,0.5697128584840487,0.5697128584840487,0.62296069296583,0.7596939046640568,0.8415850353391316,0.8863125077498096,0.9420934228473243,0.9420934228473243,0.9549891059819673,0.9600552672134341,0.9159477795688449,0.8699980514764495,0.8000991975625742,0.8000991975625742,0.7563459869271784,0.7536003401059288,0.7456113935486157,0.8144651302853702,0.8757550528758437,0.8757550528758437],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('6f4b3da7-3a0e-431e-aefa-a3f8ce7de2bd');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Finally, these predictions can also be visualized on the actual time series data.</p>
<p>As can be seen below, the predicted values match the target and training values nicely, suggesting the success of the model. Even though the cost becomes a lot more volatile around step 500, we can see the predictions do a great job of picking up on the pattern.</p>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(X.shape,Y.shape)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, Y,<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, X,<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Out-of-Pocket Cost (Scaled)'</span>)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'RNN for Out-of-Pocket Drug Cost: Actual and Predicted Values'</span>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>plot_result(trainY, testY, train_predict, test_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(603,) (67,)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deep-learning_files/figure-html/cell-19-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>As seen earlier, the training and testing MSE and RMSE are below. This is very low, and will act as a point of comparison when moving to the GRU and LSTM models.</p>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse<span class="op">**</span><span class="fl">2.0</span>,train_rmse))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse<span class="op">**</span><span class="fl">2.0</span>,test_rmse))    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00049 RMSE = 0.02216
Test MSE = 0.00072 RMSE = 0.02683</code></pre>
</div>
</div>
<p>However, even before training those models, I can already say that the RNN model improves a lot on what was seen in the original ARIMA(1,0,0) model. Even though I used AIC and BIC to measure the success of that model, the predictions from the much less complex ARIMA model seen below are unable to compare to that to of the RNN.</p>
<p>However, it is very important to note that overfitting might be occurring. After all the models have been run, I will be performing forecasting to see how the “best” deep learning model attempts to forecast the next 10 years. If it performs poorly, I will have to conclude that the model is performing so well likely becasue it is overfitting, and therefore may not be reliable.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./datasets/arima.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">arima</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="gated-recurrent-unit-gru" class="level3">
<h3 class="anchored" data-anchor-id="gated-recurrent-unit-gru">Gated Recurrent Unit (GRU)</h3>
<p>Next, I will move to the GRU to see how it performs comparatively to the successful RNN. The process is very similar to what was done before, and I will be using the same number of recurrent hidden units and epochs, the same fraction batch size, and the same validation split of 0.2. Once again, I am applying regularization to the model.</p>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>drug_gru <span class="op">=</span> Sequential()</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>drug_gru.add(GRU(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    recurrent_hidden_units,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># recurrent_dropout=0.8,</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>          ) </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>drug_gru.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>drug_gru.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>drug_gru.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_1"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Layer (type)                Output Shape              Param #   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> gru (GRU)                   (None, 3)                 54        </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense_1 (Dense)             (None, 1)                 4         </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total params: 58</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Trainable params: 58</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-trainable params: 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
</div>
<p>Now, I will begin the training process again for the GRU model this time.</p>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">73</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> drug_gru.fit(</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Once again, I will take a look at the visual learning history to ensure everything looks normal and that the model is learning as expected. Interestingly enough, the GRU model appears to be learning more quickly than the RNN, as the validation loss plummets before epoch 50.</p>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> drug_gru.predict(trainX).squeeze()</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> drug_gru.predict(testX).squeeze()</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainY.shape, train_predict.shape)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean((trainY<span class="op">-</span>train_predict)<span class="op">**</span><span class="fl">2.0</span>))</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean((testY<span class="op">-</span>test_predict)<span class="op">**</span><span class="fl">2.0</span>))</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse<span class="op">**</span><span class="fl">2.0</span>,train_rmse))</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse<span class="op">**</span><span class="fl">2.0</span>,test_rmse))    </span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Montly Out-of-Pocket Drug Cost Since 1960"</span>,x_label<span class="op">=</span><span class="st">"training epochs"</span>,y_label<span class="op">=</span><span class="st">"loss (MSE)"</span>)</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(history.history[<span class="st">'loss'</span>])</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="co"># SIMPLE PLOT </span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs_steps, history.history[<span class="st">'loss'</span>], <span class="st">'bo'</span>, label<span class="op">=</span><span class="st">'Training loss'</span>)</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs_steps, history.history[<span class="st">'val_loss'</span>], <span class="st">'b'</span>, label<span class="op">=</span><span class="st">'Validation loss'</span>)</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1/3 [=========&gt;....................] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>3/3 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 32ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(67, 9, 1) (67,) (67,) (16, 9, 1) (16,) (16,)
(67,) (67,)
0.0006124453594978368
0.0010372420079687956
Train MSE = 0.00061 RMSE = 0.02475
Test MSE = 0.00104 RMSE = 0.03221</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="6ec5da5e-d6ed-4f76-8104-22f61c01d361" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("6ec5da5e-d6ed-4f76-8104-22f61c01d361")) {                    Plotly.newPlot(                        "6ec5da5e-d6ed-4f76-8104-22f61c01d361",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.045946765691041946,0.04077000543475151,0.037123531103134155,0.03512134030461311,0.03387007489800453,0.032630860805511475,0.031608302146196365,0.03044089488685131,0.029483737424016,0.02852064184844494,0.027765247970819473,0.027193669229745865,0.02652776427567005,0.025905674323439598,0.0252818763256073,0.024648599326610565,0.024101365357637405,0.023567024618387222,0.022943727672100067,0.022302810102701187,0.02170705422759056,0.021067962050437927,0.02042432501912117,0.019882433116436005,0.0193316712975502,0.018914494663476944,0.018645567819476128,0.018308769911527634,0.018033260479569435,0.017735840752720833,0.017482802271842957,0.017207931727170944,0.0169361624866724,0.016665974631905556,0.01637326180934906,0.016049513593316078,0.015716826543211937,0.015380452387034893,0.015102222561836243,0.014928366988897324,0.01473533920943737,0.01456715352833271,0.014329473488032818,0.014100529253482819,0.013832846656441689,0.013571139425039291,0.013342006132006645,0.013085722923278809,0.012948538176715374,0.012840689159929752,0.012727552093565464,0.012563807889819145,0.012440881691873074,0.01220031175762415,0.011977349407970905,0.011739141307771206,0.01151574682444334,0.011275784112513065,0.011007157154381275,0.010741603560745716,0.010498917661607265,0.010206210426986217,0.009946929290890694,0.009698163717985153,0.009457026608288288,0.009221752174198627,0.008974413387477398,0.008772369474172592,0.008636323735117912,0.00840245932340622,0.008297747932374477,0.0082112867385149,0.008186455816030502,0.008118980564177036,0.008080889470875263,0.007972044870257378,0.007918632589280605,0.007788263261318207,0.007688136771321297,0.00760680204257369,0.007509226910769939,0.007439184468239546,0.007371900137513876,0.0072461687959730625,0.007152303121984005,0.0070079476572573185,0.006885470822453499,0.006741265766322613,0.006606162525713444,0.00652932608500123,0.0064463624730706215,0.006340956315398216,0.00623974809423089,0.0061436002142727375,0.006119867321103811,0.006065813824534416,0.006014786195009947,0.005962572060525417,0.0058690207079052925,0.005799503065645695,0.005717719439417124,0.00565487053245306,0.005561655852943659,0.0054129334166646,0.005276959389448166,0.005120439920574427,0.004968269262462854,0.004823258612304926,0.004728130530565977,0.004596055019646883,0.00447835074737668,0.004337776452302933,0.004209819715470076,0.0040570590645074844,0.003912049811333418,0.003759587649255991,0.00361969624646008,0.0034525643568485975,0.003300611162558198,0.003211601637303829,0.0030436557717621326,0.0029690321534872055,0.0028861474711447954,0.0028564874082803726,0.002838809508830309,0.0028479036409407854,0.002808552933856845,0.002779827918857336,0.0027628240641206503,0.0027747992426156998,0.00267132930457592,0.002627573674544692,0.002555966842919588,0.0025067178066819906,0.0025055657606571913,0.0024230130948126316,0.002391490153968334,0.0022986270487308502,0.002232663333415985,0.0021720107179135084,0.002114848932251334,0.0020578138064593077,0.001996220089495182,0.0019438968738541007,0.0018614515429362655,0.001776668825186789,0.0017295567085966468,0.0016394869890064,0.001557159353978932,0.0015359139069914818,0.001505466178059578,0.0014817035989835858,0.0014519771793857217,0.0014098110841587186,0.001368995290249586,0.001360318623483181,0.0013035840820521116,0.001234761904925108,0.0012145850341767073,0.0011598331620916724,0.0011403544340282679,0.0011041220277547836,0.0010966000845655799,0.0010734325041994452,0.0010441540507599711,0.0010145185515284538,0.0009752204641699791,0.0009693218162283301,0.0009544508066028357,0.0009332738118246198,0.0009320328827016056,0.0009415399981662631,0.0009051605593413115,0.0008946859161369503,0.00087064562831074,0.0008647394715808332,0.0008347772527486086,0.0008141305879689753,0.0007995148189365864,0.000765583012253046,0.0007298094569705427,0.0007050323183648288,0.0006995534058660269,0.000712756474968046,0.0006973463459871709,0.0006944694323465228,0.0006915655103512108,0.0007159355445764959,0.0007287833723239601,0.0007138242945075035,0.0007268848130479455,0.0007340775337070227,0.0007454893784597516,0.000741777359507978,0.0007478689076378942,0.0007166360737755895,0.0007182320114225149,0.0007129990262910724,0.0006805167067795992,0.0006817764951847494],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.14781656861305237,0.12414179742336273,0.11207287758588791,0.10515384376049042,0.09845351427793503,0.09290450811386108,0.08469527214765549,0.08110769838094711,0.07425475865602493,0.0685563012957573,0.06784509867429733,0.06592994183301926,0.06207776814699173,0.0571022555232048,0.05025177821516991,0.04971698299050331,0.04573424905538559,0.0455351248383522,0.0463123619556427,0.04541659727692604,0.045228950679302216,0.03927770256996155,0.03926577419042587,0.03899518400430679,0.03768795728683472,0.03750740736722946,0.035194654017686844,0.034588199108839035,0.02975042536854744,0.028664568439126015,0.028173644095659256,0.028621317818760872,0.028210924938321114,0.02693764865398407,0.02627434954047203,0.02491239830851555,0.02361435815691948,0.022694585844874382,0.0218769870698452,0.02079172432422638,0.02048386074602604,0.0194120891392231,0.019221946597099304,0.01779419369995594,0.01755310781300068,0.016963666304945946,0.016059676185250282,0.016790514811873436,0.015523659065365791,0.0162639357149601,0.015143300406634808,0.014063426293432713,0.014542869292199612,0.014322599396109581,0.013984148390591145,0.013941029086709023,0.013544738292694092,0.01378778275102377,0.01305393222719431,0.013817815110087395,0.012473085895180702,0.012099145911633968,0.011944944970309734,0.012386522255837917,0.0124087855219841,0.011087036691606045,0.010985071770846844,0.011832243762910366,0.01123142708092928,0.010876250453293324,0.010653589852154255,0.010022284463047981,0.010244840756058693,0.009965942241251469,0.010164396837353706,0.01046119723469019,0.00980780366808176,0.010273324325680733,0.008984172716736794,0.009159855544567108,0.00953779835253954,0.009176074527204037,0.009072698652744293,0.009922569617629051,0.00891479104757309,0.009439154528081417,0.008823727257549763,0.008570091798901558,0.009479611180722713,0.008700772188603878,0.0082609998062253,0.008389337919652462,0.007650649640709162,0.00750960735604167,0.008391959592700005,0.00845534447580576,0.008084876462817192,0.008157958276569843,0.007917081005871296,0.007776635233312845,0.007538379170000553,0.007600339595228434,0.007573154289275408,0.007027430925518274,0.0071711004711687565,0.0066679236479103565,0.0067756217904388905,0.006615747697651386,0.006600856315344572,0.0067229121923446655,0.006321451626718044,0.005954212974756956,0.00620765145868063,0.006040091160684824,0.005990935955196619,0.006368804723024368,0.005638825241476297,0.005412958096712828,0.006151576992124319,0.005261639598757029,0.005905344150960445,0.004962609149515629,0.004660110455006361,0.005037384573370218,0.005206102970987558,0.004634986165910959,0.004845630843192339,0.004299710970371962,0.0038271413650363684,0.004678776953369379,0.004679825156927109,0.004790307488292456,0.004294876009225845,0.005086645483970642,0.004938305355608463,0.00353435380384326,0.003855374874547124,0.004233096726238728,0.003890160471200943,0.0037098396569490433,0.0038940657395869493,0.0038069754373282194,0.0036171015817672014,0.0038538589142262936,0.003634938271716237,0.0035782589111477137,0.003208328038454056,0.003154339734464884,0.0037488944362848997,0.0038971195463091135,0.0028696185909211636,0.003118313616141677,0.003037047339603305,0.0031180584337562323,0.0030638980679214,0.003445772919803858,0.0028727210592478514,0.0035935360938310623,0.0029419551137834787,0.003340821247547865,0.0027899928390979767,0.0031684734858572483,0.0034512176644057035,0.0031029055826365948,0.0028876897413283587,0.0028700963594019413,0.0031669125892221928,0.0032268392387777567,0.0025048970710486174,0.0026008174754679203,0.003329178784042597,0.0026963327545672655,0.0025427460204809904,0.0025425052735954523,0.0031096036545932293,0.0022073760628700256,0.0024323961697518826,0.0031148274429142475,0.0031845220364630222,0.002301494823768735,0.0024461355060338974,0.0026228423230350018,0.003126108320429921,0.002246979856863618,0.002189039718359709,0.002560078864917159,0.002105963183566928,0.0028416721615940332,0.002110747853294015,0.0027765061240643263,0.0023122418206185102,0.002752921776846051,0.003062464529648423,0.0018053053645417094,0.002043291926383972,0.002546288538724184,0.002632996765896678,0.0022285175509750843,0.002158677438274026,0.002780189272016287],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Montly Out-of-Pocket Drug Cost Since 1960"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('6ec5da5e-d6ed-4f76-8104-22f61c01d361');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.045946765691041946, 0.04077000543475151, 0.037123531103134155, 0.03512134030461311, 0.03387007489800453, 0.032630860805511475, 0.031608302146196365, 0.03044089488685131, 0.029483737424016, 0.02852064184844494, 0.027765247970819473, 0.027193669229745865, 0.02652776427567005, 0.025905674323439598, 0.0252818763256073, 0.024648599326610565, 0.024101365357637405, 0.023567024618387222, 0.022943727672100067, 0.022302810102701187, 0.02170705422759056, 0.021067962050437927, 0.02042432501912117, 0.019882433116436005, 0.0193316712975502, 0.018914494663476944, 0.018645567819476128, 0.018308769911527634, 0.018033260479569435, 0.017735840752720833, 0.017482802271842957, 0.017207931727170944, 0.0169361624866724, 0.016665974631905556, 0.01637326180934906, 0.016049513593316078, 0.015716826543211937, 0.015380452387034893, 0.015102222561836243, 0.014928366988897324, 0.01473533920943737, 0.01456715352833271, 0.014329473488032818, 0.014100529253482819, 0.013832846656441689, 0.013571139425039291, 0.013342006132006645, 0.013085722923278809, 0.012948538176715374, 0.012840689159929752, 0.012727552093565464, 0.012563807889819145, 0.012440881691873074, 0.01220031175762415, 0.011977349407970905, 0.011739141307771206, 0.01151574682444334, 0.011275784112513065, 0.011007157154381275, 0.010741603560745716, 0.010498917661607265, 0.010206210426986217, 0.009946929290890694, 0.009698163717985153, 0.009457026608288288, 0.009221752174198627, 0.008974413387477398, 0.008772369474172592, 0.008636323735117912, 0.00840245932340622, 0.008297747932374477, 0.0082112867385149, 0.008186455816030502, 0.008118980564177036, 0.008080889470875263, 0.007972044870257378, 0.007918632589280605, 0.007788263261318207, 0.007688136771321297, 0.00760680204257369, 0.007509226910769939, 0.007439184468239546, 0.007371900137513876, 0.0072461687959730625, 0.007152303121984005, 0.0070079476572573185, 0.006885470822453499, 0.006741265766322613, 0.006606162525713444, 0.00652932608500123, 0.0064463624730706215, 0.006340956315398216, 0.00623974809423089, 0.0061436002142727375, 0.006119867321103811, 0.006065813824534416, 0.006014786195009947, 0.005962572060525417, 0.0058690207079052925, 0.005799503065645695, 0.005717719439417124, 0.00565487053245306, 0.005561655852943659, 0.0054129334166646, 0.005276959389448166, 0.005120439920574427, 0.004968269262462854, 0.004823258612304926, 0.004728130530565977, 0.004596055019646883, 0.00447835074737668, 0.004337776452302933, 0.004209819715470076, 0.0040570590645074844, 0.003912049811333418, 0.003759587649255991, 0.00361969624646008, 0.0034525643568485975, 0.003300611162558198, 0.003211601637303829, 0.0030436557717621326, 0.0029690321534872055, 0.0028861474711447954, 0.0028564874082803726, 0.002838809508830309, 0.0028479036409407854, 0.002808552933856845, 0.002779827918857336, 0.0027628240641206503, 0.0027747992426156998, 0.00267132930457592, 0.002627573674544692, 0.002555966842919588, 0.0025067178066819906, 0.0025055657606571913, 0.0024230130948126316, 0.002391490153968334, 0.0022986270487308502, 0.002232663333415985, 0.0021720107179135084, 0.002114848932251334, 0.0020578138064593077, 0.001996220089495182, 0.0019438968738541007, 0.0018614515429362655, 0.001776668825186789, 0.0017295567085966468, 0.0016394869890064, 0.001557159353978932, 0.0015359139069914818, 0.001505466178059578, 0.0014817035989835858, 0.0014519771793857217, 0.0014098110841587186, 0.001368995290249586, 0.001360318623483181, 0.0013035840820521116, 0.001234761904925108, 0.0012145850341767073, 0.0011598331620916724, 0.0011403544340282679, 0.0011041220277547836, 0.0010966000845655799, 0.0010734325041994452, 0.0010441540507599711, 0.0010145185515284538, 0.0009752204641699791, 0.0009693218162283301, 0.0009544508066028357, 0.0009332738118246198, 0.0009320328827016056, 0.0009415399981662631, 0.0009051605593413115, 0.0008946859161369503, 0.00087064562831074, 0.0008647394715808332, 0.0008347772527486086, 0.0008141305879689753, 0.0007995148189365864, 0.000765583012253046, 0.0007298094569705427, 0.0007050323183648288, 0.0006995534058660269, 0.000712756474968046, 0.0006973463459871709, 0.0006944694323465228, 0.0006915655103512108, 0.0007159355445764959, 0.0007287833723239601, 0.0007138242945075035, 0.0007268848130479455, 0.0007340775337070227, 0.0007454893784597516, 0.000741777359507978, 0.0007478689076378942, 0.0007166360737755895, 0.0007182320114225149, 0.0007129990262910724, 0.0006805167067795992, 0.0006817764951847494]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>&lt;matplotlib.legend.Legend at 0x2c1e977c0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deep-learning_files/figure-html/cell-23-output-9.png" width="579" height="411"></p>
</div>
</div>
<p>Looking at the parity plot and the actual vs predicted values over time, we can see that the GRU seems to be performing at par with the RNN.</p>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY,y<span class="op">=</span>train_predict,height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY,y<span class="op">=</span>test_predict,mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY,y<span class="op">=</span>trainY, mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="5e6b29cc-03b0-4ed4-9b17-d4f7cb69f106" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5e6b29cc-03b0-4ed4-9b17-d4f7cb69f106")) {                    Plotly.newPlot(                        "5e6b29cc-03b0-4ed4-9b17-d4f7cb69f106",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[0.0,0.00046056011195153707,0.005668432147095816,0.007740952650877722,0.01011460861247409,0.015517333002674792,0.015517333002674792,0.018245265973464653,0.020370928028625584,0.0276336067170921,0.03195578622925266,0.03496714080739731,0.03496714080739731,0.0389173294599047,0.04396577684091191,0.049439356632951306,0.05627690291038563,0.06284874143092484,0.06284874143092484,0.07044798327812517,0.07574442456556782,0.0826882539457602,0.08934866171859777,0.10766478309390111,0.10766478309390111,0.11455547092271447,0.1407896834534923,0.15875152781960217,0.18179724726763857,0.20167218748339327,0.20167218748339327,0.23568278036596818,0.25288292916231203,0.2889129009972898,0.32294120773032436,0.36414362389952704,0.36414362389952704,0.3765610330717588,0.3787929782296778,0.38637450622641845,0.37509078348360586,0.37608275910934763,0.37608275910934763,0.39245035693408675,0.4181885816519937,0.4526420207960605,0.5113811489203408,0.5697128584840487,0.5697128584840487,0.62296069296583,0.7596939046640568,0.8415850353391316,0.8863125077498096,0.9420934228473243,0.9420934228473243,0.9549891059819673,0.9600552672134341,0.9159477795688449,0.8699980514764495,0.8000991975625742,0.8000991975625742,0.7563459869271784,0.7536003401059288,0.7456113935486157,0.8144651302853702,0.8757550528758437,0.8757550528758437],"xaxis":"x","y":[-0.008835306391119957,-0.008348880335688591,-0.002888152375817299,-0.0007449984550476074,0.0013348311185836792,0.0018607228994369507,0.007575316354632378,0.010457944124937057,0.012690961360931396,0.020065907388925552,0.02401912212371826,0.024966280907392502,0.028152529150247574,0.03232801705598831,0.03763124346733093,0.04322439804673195,0.04922070354223251,0.050700120627880096,0.05765295773744583,0.06568407267332077,0.07125089317560196,0.07834131270647049,0.08426331728696823,0.08567836880683899,0.10503247380256653,0.11230245232582092,0.1397896707057953,0.1581912338733673,0.17847780883312225,0.18310806155204773,0.2039390206336975,0.23942777514457703,0.25723615288734436,0.29342758655548096,0.3234078586101532,0.32959040999412537,0.37154844403266907,0.38409876823425293,0.38634732365608215,0.39377811551094055,0.38457444310188293,0.3826209306716919,0.3836226463317871,0.4001016914844513,0.42576292157173157,0.45913106203079224,0.5082799196243286,0.5173721313476562,0.5730382800102234,0.6226438879966736,0.744057297706604,0.8118457794189453,0.8445443511009216,0.8490834832191467,0.892648458480835,0.9024900794029236,0.9063283205032349,0.872949481010437,0.8406645059585571,0.8360408544540405,0.7786423563957214,0.7414944171905518,0.7391284704208374,0.7323582172393799,0.7829430103302002,0.7906381487846375,0.8406588435173035],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[0.8454112270384213,0.7919862540520433,0.7939879191539865,0.8137034347156041,0.7774608966751103,0.7785591554036101,0.7785591554036101,0.7870795174747135,0.801038031636937,0.8248985882061184,0.8496802649992029,0.8740368093812552,0.8740368093812552,0.8987122030715817,0.9287726073016491,0.9613838059979098],"y":[0.8161301612854004,0.7718333601951599,0.7735045552253723,0.7897167205810547,0.7636405229568481,0.7595330476760864,0.7604659199714661,0.7676813006401062,0.7794020771980286,0.7989442348480225,0.8169916868209839,0.8196092247962952,0.8392822742462158,0.8589021563529968,0.8823464512825012,0.9069777727127075],"type":"scatter"},{"mode":"lines","x":[0.0,0.00046056011195153707,0.005668432147095816,0.007740952650877722,0.01011460861247409,0.015517333002674792,0.015517333002674792,0.018245265973464653,0.020370928028625584,0.0276336067170921,0.03195578622925266,0.03496714080739731,0.03496714080739731,0.0389173294599047,0.04396577684091191,0.049439356632951306,0.05627690291038563,0.06284874143092484,0.06284874143092484,0.07044798327812517,0.07574442456556782,0.0826882539457602,0.08934866171859777,0.10766478309390111,0.10766478309390111,0.11455547092271447,0.1407896834534923,0.15875152781960217,0.18179724726763857,0.20167218748339327,0.20167218748339327,0.23568278036596818,0.25288292916231203,0.2889129009972898,0.32294120773032436,0.36414362389952704,0.36414362389952704,0.3765610330717588,0.3787929782296778,0.38637450622641845,0.37509078348360586,0.37608275910934763,0.37608275910934763,0.39245035693408675,0.4181885816519937,0.4526420207960605,0.5113811489203408,0.5697128584840487,0.5697128584840487,0.62296069296583,0.7596939046640568,0.8415850353391316,0.8863125077498096,0.9420934228473243,0.9420934228473243,0.9549891059819673,0.9600552672134341,0.9159477795688449,0.8699980514764495,0.8000991975625742,0.8000991975625742,0.7563459869271784,0.7536003401059288,0.7456113935486157,0.8144651302853702,0.8757550528758437,0.8757550528758437],"y":[0.0,0.00046056011195153707,0.005668432147095816,0.007740952650877722,0.01011460861247409,0.015517333002674792,0.015517333002674792,0.018245265973464653,0.020370928028625584,0.0276336067170921,0.03195578622925266,0.03496714080739731,0.03496714080739731,0.0389173294599047,0.04396577684091191,0.049439356632951306,0.05627690291038563,0.06284874143092484,0.06284874143092484,0.07044798327812517,0.07574442456556782,0.0826882539457602,0.08934866171859777,0.10766478309390111,0.10766478309390111,0.11455547092271447,0.1407896834534923,0.15875152781960217,0.18179724726763857,0.20167218748339327,0.20167218748339327,0.23568278036596818,0.25288292916231203,0.2889129009972898,0.32294120773032436,0.36414362389952704,0.36414362389952704,0.3765610330717588,0.3787929782296778,0.38637450622641845,0.37509078348360586,0.37608275910934763,0.37608275910934763,0.39245035693408675,0.4181885816519937,0.4526420207960605,0.5113811489203408,0.5697128584840487,0.5697128584840487,0.62296069296583,0.7596939046640568,0.8415850353391316,0.8863125077498096,0.9420934228473243,0.9420934228473243,0.9549891059819673,0.9600552672134341,0.9159477795688449,0.8699980514764495,0.8000991975625742,0.8000991975625742,0.7563459869271784,0.7536003401059288,0.7456113935486157,0.8144651302853702,0.8757550528758437,0.8757550528758437],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('5e6b29cc-03b0-4ed4-9b17-d4f7cb69f106');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(X.shape,Y.shape)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, Y,<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, X,<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Out-of-Pocket Cost (Scaled)'</span>)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'GRU for Out-of-Pocket Drug Cost: Actual and Predicted Values'</span>)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>plot_result(trainY, testY, train_predict, test_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(603,) (67,)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deep-learning_files/figure-html/cell-25-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The results of the training and testing MSE for the GRU model is interesting, and very close to the RNN model. Because the test MSE and RMSE are higher for the RNN model, at 0.00103 and 0.03206, respectively, I believe the GRU is an improvement.</p>
<div class="cell" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse<span class="op">**</span><span class="fl">2.0</span>,train_rmse))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse<span class="op">**</span><span class="fl">2.0</span>,test_rmse))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00061 RMSE = 0.02475
Test MSE = 0.00104 RMSE = 0.03221</code></pre>
</div>
</div>
</section>
<section id="long-short-term-memory-lstm" class="level3">
<h3 class="anchored" data-anchor-id="long-short-term-memory-lstm">Long Short-Term Memory (LSTM)</h3>
<p>Finally, I am going to look at the last model, LSTM, to determine if it is able to outperform the current leader of RNN in terms of predictive ability and minimal testing error.</p>
<p>As before, the process is nearly the same to set up the LSTM model, and regularization is added.</p>
<div class="cell" data-execution_count="26">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>drug_lstm <span class="op">=</span> Sequential()</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>drug_lstm.add(LSTM(</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    recurrent_hidden_units,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># recurrent_dropout=0.8,</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>    activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>          ) </span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>drug_lstm.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>drug_lstm.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>drug_lstm.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_2"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Layer (type)                Output Shape              Param #   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> lstm (LSTM)                 (None, 3)                 60        </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense_2 (Dense)             (None, 1)                 4         </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total params: 64</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Trainable params: 64</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-trainable params: 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
</div>
<p>Once again, I will perform the training process, using the same recurrent hidden units, epoch size, fraction batch size, and validation split.</p>
<div class="cell" data-execution_count="27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">73</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> drug_lstm.fit(</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, </span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below, we can see the visual learning history of the LSTM model. Similar to the GRU model, the MSE loss decreases significantly after 50 training epochs.</p>
<div class="cell" data-execution_count="28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> drug_gru.predict(trainX).squeeze()</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> drug_gru.predict(testX).squeeze()</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainY.shape, train_predict.shape)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean((trainY<span class="op">-</span>train_predict)<span class="op">**</span><span class="fl">2.0</span>))</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean((testY<span class="op">-</span>test_predict)<span class="op">**</span><span class="fl">2.0</span>))</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse<span class="op">**</span><span class="fl">2.0</span>,train_rmse))</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse<span class="op">**</span><span class="fl">2.0</span>,test_rmse))    </span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Montly Out-of-Pocket Drug Cost Since 1960"</span>,x_label<span class="op">=</span><span class="st">"training epochs"</span>,y_label<span class="op">=</span><span class="st">"loss (MSE)"</span>)</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(history.history[<span class="st">'loss'</span>])</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a><span class="co"># SIMPLE PLOT </span></span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs_steps, history.history[<span class="st">'loss'</span>], <span class="st">'bo'</span>, label<span class="op">=</span><span class="st">'Training loss'</span>)</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs_steps, history.history[<span class="st">'val_loss'</span>], <span class="st">'b'</span>, label<span class="op">=</span><span class="st">'Validation loss'</span>)</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1/3 [=========&gt;....................] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>3/3 [==============================] - 0s 9ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(67, 9, 1) (67,) (67,) (16, 9, 1) (16,) (16,)
(67,) (67,)
0.0006124453594978368
0.0010372420079687956
Train MSE = 0.00061 RMSE = 0.02475
Test MSE = 0.00104 RMSE = 0.03221</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="1d22f05e-ffbb-4ec1-bd9a-7d91ca1ef19b" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("1d22f05e-ffbb-4ec1-bd9a-7d91ca1ef19b")) {                    Plotly.newPlot(                        "1d22f05e-ffbb-4ec1-bd9a-7d91ca1ef19b",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.06714951246976852,0.06004905328154564,0.05583866313099861,0.052344903349876404,0.04872582107782364,0.04650423303246498,0.04377543181180954,0.041556548327207565,0.040511637926101685,0.03923078253865242,0.03797265887260437,0.03692369535565376,0.03572447970509529,0.034433361142873764,0.03321843966841698,0.03198758885264397,0.030818916857242584,0.029455842450261116,0.028298206627368927,0.02724018320441246,0.02613206021487713,0.025013374164700508,0.02397511899471283,0.02293509431183338,0.021966908127069473,0.02110959030687809,0.02017028070986271,0.01937098056077957,0.018509969115257263,0.01785915717482567,0.01698448322713375,0.01637633703649044,0.015767447650432587,0.015271159820258617,0.014821969904005527,0.014369979500770569,0.013971555978059769,0.01354865450412035,0.01314583607017994,0.01273350790143013,0.012322219088673592,0.011918140575289726,0.011587785556912422,0.011157318018376827,0.010776191018521786,0.010408402420580387,0.010007131844758987,0.009636622853577137,0.009338376112282276,0.009027869440615177,0.00870448537170887,0.00845449697226286,0.00818713754415512,0.007912750355899334,0.00768527016043663,0.007439623586833477,0.00713157095015049,0.006940730847418308,0.006677067372947931,0.006451224908232689,0.006227227859199047,0.005998663138598204,0.005776026751846075,0.005567565094679594,0.005347870290279388,0.005143230780959129,0.004944264888763428,0.00473196292296052,0.004510332364588976,0.0043345182202756405,0.004208924248814583,0.0040078675374388695,0.0037964601069688797,0.003642226802185178,0.0034810160286724567,0.003411815967410803,0.003174696583300829,0.003065528115257621,0.0029390256386250257,0.0028099354822188616,0.002684312406927347,0.0025521006900817156,0.0024666457902640104,0.0023132532369345427,0.002225111471489072,0.0020912440959364176,0.002079904079437256,0.0019056717865169048,0.0018369873287156224,0.0017672769026830792,0.0016848505474627018,0.001594441244378686,0.001514654722996056,0.0014350945129990578,0.0014070163015276194,0.0013065582606941462,0.0012147227535024285,0.0011577479308471084,0.0011374135501682758,0.0010415965225547552,0.0009879037970677018,0.0009444777970202267,0.0009142417693510652,0.0008715814328752458,0.0008169252541847527,0.0007830756367184222,0.0007272980292327702,0.0006744689308106899,0.0006416290416382253,0.0006580441840924323,0.0006189623381942511,0.0005990457721054554,0.0005343692027963698,0.0005105301388539374,0.0004766367783304304,0.00043384250602684915,0.0004585082642734051,0.0004130617599003017,0.0004338454164098948,0.0003634121676441282,0.0003466330817900598,0.0003407635958865285,0.0003443733439780772,0.00032246249611489475,0.000352640199707821,0.00030464347219094634,0.0002893820055760443,0.00030409611645154655,0.00028575363103300333,0.0003002011217176914,0.0002917205565609038,0.00031292211497202516,0.00026176945539191365,0.00030367891304194927,0.0002582249871920794,0.00024600530741736293,0.0002565687464084476,0.00025598067441023886,0.000240602224948816,0.000250667188083753,0.00030164490453898907,0.0002384562831139192,0.00023486703867092729,0.0002274776779813692,0.00022697645181324333,0.00021999733871780336,0.00021481089061126113,0.00022623781114816666,0.00023826851975172758,0.00021481502335518599,0.00025183684192597866,0.00026328032254241407,0.00020990039047319442,0.00023282362963072956,0.00023265146592166275,0.00019762797455769032,0.00021513337560463697,0.0002078738179989159,0.0002142615703633055,0.00018810013716574758,0.00024997032596729696,0.00018855022790376097,0.00023026223061606288,0.0001875800808193162,0.00018106774950865656,0.0001828778040362522,0.00021682181977666914,0.00017796775500755757,0.00024335341004189104,0.00019693723879754543,0.00018415266822557896,0.00017407578707206994,0.00018040742725133896,0.0001738257851684466,0.0002037809754256159,0.0002053333300864324,0.00017326875240541995,0.0001707807823549956,0.0001738407590892166,0.00016704191511962563,0.0001874560402939096,0.0002182480093324557,0.00017372978618368506,0.00019053139840252697,0.00016177614452317357,0.00016052098362706602,0.00019628724840003997,0.00020310714899096638,0.00017061027756426483,0.00016299109847750515,0.00017989618936553597,0.00016738014528527856,0.00016683882859069854,0.0001590391475474462,0.00015230306598823518,0.0002081106649711728,0.00017592207586858422,0.00016233585483860224,0.0001667087635723874,0.00015584335778839886],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.32189056277275085,0.2979643940925598,0.27963733673095703,0.25654393434524536,0.24311251938343048,0.2235591858625412,0.20385071635246277,0.19913478195667267,0.18986020982265472,0.18076221644878387,0.17614439129829407,0.17125846445560455,0.16516980528831482,0.15932711958885193,0.1531125009059906,0.14654971659183502,0.1358223408460617,0.1310644894838333,0.12550409138202667,0.12034007161855698,0.11428177356719971,0.1082669273018837,0.10092391073703766,0.0955006405711174,0.09065288305282593,0.08589620888233185,0.08096684515476227,0.07618290930986404,0.07068518549203873,0.061721451580524445,0.061249714344739914,0.05299067124724388,0.052735406905412674,0.0471157468855381,0.04713493213057518,0.04477914795279503,0.044608522206544876,0.044612329453229904,0.04451384022831917,0.04181268811225891,0.04115235060453415,0.040745191276073456,0.038659028708934784,0.03534448891878128,0.03367319703102112,0.03275546431541443,0.031259987503290176,0.029774876311421394,0.025606220588088036,0.02595716342329979,0.027417967095971107,0.026666000485420227,0.026083929464221,0.02680741623044014,0.027010932564735413,0.024056239053606987,0.019778341054916382,0.02006327547132969,0.020133528858423233,0.020294416695833206,0.019819842651486397,0.019390897825360298,0.01906357705593109,0.01898561231791973,0.019951248541474342,0.01723656989634037,0.016576776280999184,0.015882771462202072,0.014790193177759647,0.017822090536355972,0.01634848676621914,0.015806347131729126,0.014214999973773956,0.01252803485840559,0.010314726270735264,0.013094896450638771,0.00972545612603426,0.01162157766520977,0.011491016484797001,0.010602704249322414,0.010206909850239754,0.009990823455154896,0.00955150369554758,0.011057051829993725,0.00914203654974699,0.006888888776302338,0.008258173242211342,0.00794254057109356,0.00884278304874897,0.008926496841013432,0.007953288033604622,0.008360166102647781,0.007343923207372427,0.007465575356036425,0.006787104066461325,0.007175896316766739,0.006622976157814264,0.004690826404839754,0.006177788134664297,0.005684471223503351,0.0058517842553555965,0.005366108845919371,0.005504689645022154,0.004972894676029682,0.00473443791270256,0.00455167843028903,0.0048240977339446545,0.004574075806885958,0.006529264617711306,0.006030962336808443,0.004549055360257626,0.00430940231308341,0.003966364543884993,0.003435304155573249,0.003474768251180649,0.003607351565733552,0.003377157961949706,0.004836914129555225,0.0035350616089999676,0.0032684949692338705,0.003215931821614504,0.0025465916842222214,0.002534161088988185,0.004048401955515146,0.0021852210629731417,0.0024506808258593082,0.003269147826358676,0.0027465340681374073,0.0038073293399065733,0.0024523441679775715,0.0035396157763898373,0.0029341576155275106,0.001660226029343903,0.002355566481128335,0.0022105686366558075,0.002667148830369115,0.0025047508534044027,0.002352581126615405,0.0030412727501243353,0.0014367824187502265,0.0017091218614950776,0.0021927813068032265,0.0019602770917117596,0.0019223594572395086,0.001981923822313547,0.0019748019985854626,0.0020771794952452183,0.002990830224007368,0.002172399079427123,0.0030642107594758272,0.002882295520976186,0.0021769474260509014,0.002625307533890009,0.0020652892999351025,0.0018069271463900805,0.0019773656968027353,0.001426170696504414,0.0022572812158614397,0.0017824888927862048,0.0011956023517996073,0.0020516468212008476,0.0012083855690434575,0.0014962806599214673,0.0015741420211270452,0.0015205352101475,0.0011791825527325273,0.0014939968241378665,0.0011427903082221746,0.0011861410457640886,0.0013175166677683592,0.0013287810143083334,0.001266416278667748,0.0013968177372589707,0.002074419753625989,0.0020830926951020956,0.0015919419238343835,0.0015153789427131414,0.0014338662149384618,0.0013871510745957494,0.0011223098263144493,0.0011141253635287285,0.0012061872985213995,0.0016691499622538686,0.0013769125798717141,0.0013148101279512048,0.001958792097866535,0.0017701537581160665,0.001430321717634797,0.0013616151409223676,0.0018381507834419608,0.001165136811323464,0.001538721495307982,0.0012279324000701308,0.0011481327237561345,0.001753473305143416,0.0012887397315353155,0.0013280075509101152,0.001206442597322166,0.0012208782136440277,0.0011927068699151278],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Montly Out-of-Pocket Drug Cost Since 1960"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('1d22f05e-ffbb-4ec1-bd9a-7d91ca1ef19b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.06714951246976852, 0.06004905328154564, 0.05583866313099861, 0.052344903349876404, 0.04872582107782364, 0.04650423303246498, 0.04377543181180954, 0.041556548327207565, 0.040511637926101685, 0.03923078253865242, 0.03797265887260437, 0.03692369535565376, 0.03572447970509529, 0.034433361142873764, 0.03321843966841698, 0.03198758885264397, 0.030818916857242584, 0.029455842450261116, 0.028298206627368927, 0.02724018320441246, 0.02613206021487713, 0.025013374164700508, 0.02397511899471283, 0.02293509431183338, 0.021966908127069473, 0.02110959030687809, 0.02017028070986271, 0.01937098056077957, 0.018509969115257263, 0.01785915717482567, 0.01698448322713375, 0.01637633703649044, 0.015767447650432587, 0.015271159820258617, 0.014821969904005527, 0.014369979500770569, 0.013971555978059769, 0.01354865450412035, 0.01314583607017994, 0.01273350790143013, 0.012322219088673592, 0.011918140575289726, 0.011587785556912422, 0.011157318018376827, 0.010776191018521786, 0.010408402420580387, 0.010007131844758987, 0.009636622853577137, 0.009338376112282276, 0.009027869440615177, 0.00870448537170887, 0.00845449697226286, 0.00818713754415512, 0.007912750355899334, 0.00768527016043663, 0.007439623586833477, 0.00713157095015049, 0.006940730847418308, 0.006677067372947931, 0.006451224908232689, 0.006227227859199047, 0.005998663138598204, 0.005776026751846075, 0.005567565094679594, 0.005347870290279388, 0.005143230780959129, 0.004944264888763428, 0.00473196292296052, 0.004510332364588976, 0.0043345182202756405, 0.004208924248814583, 0.0040078675374388695, 0.0037964601069688797, 0.003642226802185178, 0.0034810160286724567, 0.003411815967410803, 0.003174696583300829, 0.003065528115257621, 0.0029390256386250257, 0.0028099354822188616, 0.002684312406927347, 0.0025521006900817156, 0.0024666457902640104, 0.0023132532369345427, 0.002225111471489072, 0.0020912440959364176, 0.002079904079437256, 0.0019056717865169048, 0.0018369873287156224, 0.0017672769026830792, 0.0016848505474627018, 0.001594441244378686, 0.001514654722996056, 0.0014350945129990578, 0.0014070163015276194, 0.0013065582606941462, 0.0012147227535024285, 0.0011577479308471084, 0.0011374135501682758, 0.0010415965225547552, 0.0009879037970677018, 0.0009444777970202267, 0.0009142417693510652, 0.0008715814328752458, 0.0008169252541847527, 0.0007830756367184222, 0.0007272980292327702, 0.0006744689308106899, 0.0006416290416382253, 0.0006580441840924323, 0.0006189623381942511, 0.0005990457721054554, 0.0005343692027963698, 0.0005105301388539374, 0.0004766367783304304, 0.00043384250602684915, 0.0004585082642734051, 0.0004130617599003017, 0.0004338454164098948, 0.0003634121676441282, 0.0003466330817900598, 0.0003407635958865285, 0.0003443733439780772, 0.00032246249611489475, 0.000352640199707821, 0.00030464347219094634, 0.0002893820055760443, 0.00030409611645154655, 0.00028575363103300333, 0.0003002011217176914, 0.0002917205565609038, 0.00031292211497202516, 0.00026176945539191365, 0.00030367891304194927, 0.0002582249871920794, 0.00024600530741736293, 0.0002565687464084476, 0.00025598067441023886, 0.000240602224948816, 0.000250667188083753, 0.00030164490453898907, 0.0002384562831139192, 0.00023486703867092729, 0.0002274776779813692, 0.00022697645181324333, 0.00021999733871780336, 0.00021481089061126113, 0.00022623781114816666, 0.00023826851975172758, 0.00021481502335518599, 0.00025183684192597866, 0.00026328032254241407, 0.00020990039047319442, 0.00023282362963072956, 0.00023265146592166275, 0.00019762797455769032, 0.00021513337560463697, 0.0002078738179989159, 0.0002142615703633055, 0.00018810013716574758, 0.00024997032596729696, 0.00018855022790376097, 0.00023026223061606288, 0.0001875800808193162, 0.00018106774950865656, 0.0001828778040362522, 0.00021682181977666914, 0.00017796775500755757, 0.00024335341004189104, 0.00019693723879754543, 0.00018415266822557896, 0.00017407578707206994, 0.00018040742725133896, 0.0001738257851684466, 0.0002037809754256159, 0.0002053333300864324, 0.00017326875240541995, 0.0001707807823549956, 0.0001738407590892166, 0.00016704191511962563, 0.0001874560402939096, 0.0002182480093324557, 0.00017372978618368506, 0.00019053139840252697, 0.00016177614452317357, 0.00016052098362706602, 0.00019628724840003997, 0.00020310714899096638, 0.00017061027756426483, 0.00016299109847750515, 0.00017989618936553597, 0.00016738014528527856, 0.00016683882859069854, 0.0001590391475474462, 0.00015230306598823518, 0.0002081106649711728, 0.00017592207586858422, 0.00016233585483860224, 0.0001667087635723874, 0.00015584335778839886]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>&lt;matplotlib.legend.Legend at 0x2d4d2e110&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deep-learning_files/figure-html/cell-29-output-9.png" width="579" height="411"></p>
</div>
</div>
<p>Once again, the parity plot and the predicted vs actual values plot match that of the RNN and GRU models, suggesting that LSTM is also quite successful and predicting the out-of-pocket drug cost. This means that the differences in the success of the LSTM when compared to the other models is likely very small.</p>
<div class="cell" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY,y<span class="op">=</span>train_predict,height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY,y<span class="op">=</span>test_predict,mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY,y<span class="op">=</span>trainY, mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="d244cd76-1955-4f15-8438-f1bc0fcda43f" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d244cd76-1955-4f15-8438-f1bc0fcda43f")) {                    Plotly.newPlot(                        "d244cd76-1955-4f15-8438-f1bc0fcda43f",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[0.0,0.00046056011195153707,0.005668432147095816,0.007740952650877722,0.01011460861247409,0.015517333002674792,0.015517333002674792,0.018245265973464653,0.020370928028625584,0.0276336067170921,0.03195578622925266,0.03496714080739731,0.03496714080739731,0.0389173294599047,0.04396577684091191,0.049439356632951306,0.05627690291038563,0.06284874143092484,0.06284874143092484,0.07044798327812517,0.07574442456556782,0.0826882539457602,0.08934866171859777,0.10766478309390111,0.10766478309390111,0.11455547092271447,0.1407896834534923,0.15875152781960217,0.18179724726763857,0.20167218748339327,0.20167218748339327,0.23568278036596818,0.25288292916231203,0.2889129009972898,0.32294120773032436,0.36414362389952704,0.36414362389952704,0.3765610330717588,0.3787929782296778,0.38637450622641845,0.37509078348360586,0.37608275910934763,0.37608275910934763,0.39245035693408675,0.4181885816519937,0.4526420207960605,0.5113811489203408,0.5697128584840487,0.5697128584840487,0.62296069296583,0.7596939046640568,0.8415850353391316,0.8863125077498096,0.9420934228473243,0.9420934228473243,0.9549891059819673,0.9600552672134341,0.9159477795688449,0.8699980514764495,0.8000991975625742,0.8000991975625742,0.7563459869271784,0.7536003401059288,0.7456113935486157,0.8144651302853702,0.8757550528758437,0.8757550528758437],"xaxis":"x","y":[-0.008835306391119957,-0.008348880335688591,-0.002888152375817299,-0.0007449984550476074,0.0013348311185836792,0.0018607228994369507,0.007575316354632378,0.010457944124937057,0.012690961360931396,0.020065907388925552,0.02401912212371826,0.024966280907392502,0.028152529150247574,0.03232801705598831,0.03763124346733093,0.04322439804673195,0.04922070354223251,0.050700120627880096,0.05765295773744583,0.06568407267332077,0.07125089317560196,0.07834131270647049,0.08426331728696823,0.08567836880683899,0.10503247380256653,0.11230245232582092,0.1397896707057953,0.1581912338733673,0.17847780883312225,0.18310806155204773,0.2039390206336975,0.23942777514457703,0.25723615288734436,0.29342758655548096,0.3234078586101532,0.32959040999412537,0.37154844403266907,0.38409876823425293,0.38634732365608215,0.39377811551094055,0.38457444310188293,0.3826209306716919,0.3836226463317871,0.4001016914844513,0.42576292157173157,0.45913106203079224,0.5082799196243286,0.5173721313476562,0.5730382800102234,0.6226438879966736,0.744057297706604,0.8118457794189453,0.8445443511009216,0.8490834832191467,0.892648458480835,0.9024900794029236,0.9063283205032349,0.872949481010437,0.8406645059585571,0.8360408544540405,0.7786423563957214,0.7414944171905518,0.7391284704208374,0.7323582172393799,0.7829430103302002,0.7906381487846375,0.8406588435173035],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[0.8454112270384213,0.7919862540520433,0.7939879191539865,0.8137034347156041,0.7774608966751103,0.7785591554036101,0.7785591554036101,0.7870795174747135,0.801038031636937,0.8248985882061184,0.8496802649992029,0.8740368093812552,0.8740368093812552,0.8987122030715817,0.9287726073016491,0.9613838059979098],"y":[0.8161301612854004,0.7718333601951599,0.7735045552253723,0.7897167205810547,0.7636405229568481,0.7595330476760864,0.7604659199714661,0.7676813006401062,0.7794020771980286,0.7989442348480225,0.8169916868209839,0.8196092247962952,0.8392822742462158,0.8589021563529968,0.8823464512825012,0.9069777727127075],"type":"scatter"},{"mode":"lines","x":[0.0,0.00046056011195153707,0.005668432147095816,0.007740952650877722,0.01011460861247409,0.015517333002674792,0.015517333002674792,0.018245265973464653,0.020370928028625584,0.0276336067170921,0.03195578622925266,0.03496714080739731,0.03496714080739731,0.0389173294599047,0.04396577684091191,0.049439356632951306,0.05627690291038563,0.06284874143092484,0.06284874143092484,0.07044798327812517,0.07574442456556782,0.0826882539457602,0.08934866171859777,0.10766478309390111,0.10766478309390111,0.11455547092271447,0.1407896834534923,0.15875152781960217,0.18179724726763857,0.20167218748339327,0.20167218748339327,0.23568278036596818,0.25288292916231203,0.2889129009972898,0.32294120773032436,0.36414362389952704,0.36414362389952704,0.3765610330717588,0.3787929782296778,0.38637450622641845,0.37509078348360586,0.37608275910934763,0.37608275910934763,0.39245035693408675,0.4181885816519937,0.4526420207960605,0.5113811489203408,0.5697128584840487,0.5697128584840487,0.62296069296583,0.7596939046640568,0.8415850353391316,0.8863125077498096,0.9420934228473243,0.9420934228473243,0.9549891059819673,0.9600552672134341,0.9159477795688449,0.8699980514764495,0.8000991975625742,0.8000991975625742,0.7563459869271784,0.7536003401059288,0.7456113935486157,0.8144651302853702,0.8757550528758437,0.8757550528758437],"y":[0.0,0.00046056011195153707,0.005668432147095816,0.007740952650877722,0.01011460861247409,0.015517333002674792,0.015517333002674792,0.018245265973464653,0.020370928028625584,0.0276336067170921,0.03195578622925266,0.03496714080739731,0.03496714080739731,0.0389173294599047,0.04396577684091191,0.049439356632951306,0.05627690291038563,0.06284874143092484,0.06284874143092484,0.07044798327812517,0.07574442456556782,0.0826882539457602,0.08934866171859777,0.10766478309390111,0.10766478309390111,0.11455547092271447,0.1407896834534923,0.15875152781960217,0.18179724726763857,0.20167218748339327,0.20167218748339327,0.23568278036596818,0.25288292916231203,0.2889129009972898,0.32294120773032436,0.36414362389952704,0.36414362389952704,0.3765610330717588,0.3787929782296778,0.38637450622641845,0.37509078348360586,0.37608275910934763,0.37608275910934763,0.39245035693408675,0.4181885816519937,0.4526420207960605,0.5113811489203408,0.5697128584840487,0.5697128584840487,0.62296069296583,0.7596939046640568,0.8415850353391316,0.8863125077498096,0.9420934228473243,0.9420934228473243,0.9549891059819673,0.9600552672134341,0.9159477795688449,0.8699980514764495,0.8000991975625742,0.8000991975625742,0.7563459869271784,0.7536003401059288,0.7456113935486157,0.8144651302853702,0.8757550528758437,0.8757550528758437],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d244cd76-1955-4f15-8438-f1bc0fcda43f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(X.shape,Y.shape)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, Y,<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, X,<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Out-of-Pocket Cost (Scaled)'</span>)</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'GRU for Out-of-Pocket Drug Cost: Actual and Predicted Values'</span>)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>plot_result(trainY, testY, train_predict, test_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(603,) (67,)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deep-learning_files/figure-html/cell-31-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The results of the training and testing MSE and RMSE for the LSTM model are interesting, as they match that of the GRU model despite having unique training processes.</p>
<div class="cell" data-execution_count="31">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse<span class="op">**</span><span class="fl">2.0</span>,train_rmse))</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse<span class="op">**</span><span class="fl">2.0</span>,test_rmse))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00061 RMSE = 0.02475
Test MSE = 0.00104 RMSE = 0.03221</code></pre>
</div>
</div>
</section>
<section id="neural-network-model-comparison-and-forecasting-are-the-deep-learning-models-reliable" class="level3">
<h3 class="anchored" data-anchor-id="neural-network-model-comparison-and-forecasting-are-the-deep-learning-models-reliable">Neural Network Model Comparison and Forecasting: Are the Deep Learning Models Reliable?</h3>
<p>Because the GRU and LSTM perform equaly well, it’s a bit difficult to determine which is best. However, I believe that the GRU is the model, as it is far less complex than the LSTM. This is important for two reasons. The first reason is that my dataset is relatively small, even after changing the time series from yearly to monthly, therefore the computing power and possible overfitting of the LSTM may not be necessary, especially if they have the same error rates. The second reason is that all modeling and simulation for this project is done on an M2 Mac chip, which is considered by many to perhaps be a bit too efficient when it comes to faster training times and increased computational power. Because these tensorflow and keras models were not developed for the M2 chip’s power, it is possible that an M2 chip may overfit when compared to other chips, which also leads me to believe that the GRU is a better choice due to its lower complexity.</p>
<p>Just as I did before with the ARIMA models in an earlier tab of this portfolio, I am going to attempt to use the GRU to forecast out-of-pocket drug costs ten years into the future. Again, I will be using the monthly data used to train the model, making it a bit different from the ARIMA modeling.</p>
<div class="cell" data-execution_count="32">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>num_steps <span class="op">=</span> <span class="dv">10</span> <span class="op">*</span> <span class="dv">12</span> <span class="co">#because I converted the data to monthly data</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>forecast <span class="op">=</span> np.zeros((num_steps,))</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>init <span class="op">=</span> trainX[<span class="op">-</span><span class="dv">1</span>,:,:]</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_steps):</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#predicting output based on input</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> drug_gru.predict(init.reshape(<span class="dv">1</span>, init.shape[<span class="dv">0</span>], init.shape[<span class="dv">1</span>]))</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#store forecasted value</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    forecast[i] <span class="op">=</span> output[<span class="dv">0</span>,<span class="dv">0</span>]</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#update initial value before repeating loop </span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>    init <span class="op">=</span> np.vstack([init[<span class="dv">1</span>:,:], output])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 49ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 19ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 25ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 72ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 20ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 13ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 13ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 13ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 19ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 25ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 20ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 44ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 37ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 60ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 19ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 19ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 13ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 13ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 13ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 24ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 12ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 14ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 13ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 19ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 15ms/step</code></pre>
</div>
</div>
<p>Below are the forecasted values for the next 10 years according to the GRU model. As mentioned earlier, extremely poor forecasting by the deep learning models may suggest overfitting is present, and that the models are likely unreliable for forecasting this dataset.</p>
<p>Below, I performed the same 10-year forecasting done for the ARIMA model, where I predicted ten years into the future beginning in 1995 and ending in 2005.</p>
<div class="cell" data-execution_count="33">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>drug_subset <span class="op">=</span> drug_month.loc[drug_month.index[<span class="dv">0</span>:<span class="dv">420</span>]]</span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a>plt.plot(drug_subset)</span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a>forecast_start <span class="op">=</span> <span class="st">"1995-01-31"</span></span>
<span id="cb346-7"><a href="#cb346-7" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> pd.date_range(forecast_start, periods<span class="op">=</span>num_steps, freq<span class="op">=</span><span class="st">'M'</span>)</span>
<span id="cb346-8"><a href="#cb346-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-9"><a href="#cb346-9" aria-hidden="true" tabindex="-1"></a>plt.plot(dates, forecast)</span>
<span id="cb346-10"><a href="#cb346-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Out-of-Pocket Cost: GRU Forecast (1995-2005)'</span>)</span>
<span id="cb346-11"><a href="#cb346-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb346-12"><a href="#cb346-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Out-of-Pocket Cost (Millions of USD)'</span>)</span>
<span id="cb346-13"><a href="#cb346-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="deep-learning_files/figure-html/cell-34-output-1.png" width="610" height="449"></p>
</div>
</div>
<p>Comparing this to the differenced ARIMA(1,0,0) 10-year forecast referenced earlier, it appears that the ARIMA model is much more reliable than the GRU model, likely due to severe overfitting occurring in the training process. Because of the size of the dataset, it is likely that the neural network model does not have enough training points to work off of. Because ARIMA is so much simpler in comparison, it performs significantly better even if it not perfect by any means.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./datasets/arima.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">arima</figcaption><p></p>
</figure>
</div>
<section id="references" class="level4">
<h4 class="anchored" data-anchor-id="references">References</h4>
<p>For this section, I utilized much of the code from Professor James Hickman’s “sunspots.ipynb” lab, which can be found <a href="https://georgetown.instructure.com/courses/162127/files/folder/DL-2-share">HERE</a>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>